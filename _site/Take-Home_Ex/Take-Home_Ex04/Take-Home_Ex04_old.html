<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eda Chang">

<title>ISSS608-VA1 - Take-home Exercise 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VA1</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03_v1.html">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex04/Take-Home_Ex04_v1.html">
 <span class="dropdown-text">Take-Home Exercise 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-task" id="toc-the-task" class="nav-link active" data-scroll-target="#the-task">The task</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">1. Introduction</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">2. Data</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">3. Data Preparation</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">4. Visualization</a>
  <ul class="collapse">
  <li><a href="#heatmap" id="toc-heatmap" class="nav-link" data-scroll-target="#heatmap">4.1 Heatmap</a></li>
  <li><a href="#trade-balance-of-singapore" id="toc-trade-balance-of-singapore" class="nav-link" data-scroll-target="#trade-balance-of-singapore">4.2 Trade Balance of Singapore</a></li>
  <li><a href="#asia-1" id="toc-asia-1" class="nav-link" data-scroll-target="#asia-1">Asia</a></li>
  <li><a href="#america-1" id="toc-america-1" class="nav-link" data-scroll-target="#america-1">America</a></li>
  <li><a href="#europe-1" id="toc-europe-1" class="nav-link" data-scroll-target="#europe-1">Europe</a></li>
  <li><a href="#oceania-1" id="toc-oceania-1" class="nav-link" data-scroll-target="#oceania-1">Oceania</a></li>
  <li><a href="#export-import-graphs" id="toc-export-import-graphs" class="nav-link" data-scroll-target="#export-import-graphs">4.3 Export-Import Graphs</a></li>
  <li><a href="#slopegraph-4" id="toc-slopegraph-4" class="nav-link" data-scroll-target="#slopegraph-4">4.3 SlopeGraph</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">5. References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Take-home Exercise 4</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Eda Chang </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="the-task" class="level1">
<h1>The task</h1>
<p>With the help of analysis visualisation techniques, we are to uncover the impact of COVID-19 and the global economic and political dynamics of 2022 on Singapore’s bi-lateral trade (i.e.&nbsp;import, export and trade balance).</p>
</section>
<section id="introduction" class="level1">
<h1>1. Introduction</h1>
<p>As Singaporeans, we have always been told that Singapore’s trading success is due to its naturally deep harbor and strategic location, which connects India, China, and the Indonesian archipelago.</p>
<p>Furthermore, as a free trader with a small and open economy that is heavily reliant on trade, Singapore is more competitive than many of its neighbors in carrying out such activities.</p>
<p>Therefore, we hope to learn how the influence of COVID-19 and global economic and political dynamics will affect Singapore’s bi-lateral commerce in this activity.</p>
</section>
<section id="data" class="level1">
<h1>2. Data</h1>
<p>The dataset used for this experiment was obtained from <a href="https://www.singstat.gov.sg/find-data/search-by-theme/trade-and-investment/merchandise-trade/latest-data">Singstat.gov.sg</a> and provides information on Goods Imports and Exports by Region / Market.</p>
<p>The study period will be from <strong>January 2020 to December 2022</strong> for the purposes of this exercise.</p>
</section>
<section id="data-preparation" class="level1">
<h1>3. Data Preparation</h1>
<p>Ensure following packages are installed.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("remotes")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"nsgrantham/ggbraid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Skipping install of 'ggbraid' from a github remote, the SHA1 (e1018d7a) has not changed since last install.
  Use `force = TRUE` to force installation</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'readxl'</span>, <span class="st">'tidyr'</span>, <span class="st">'lubridate'</span>,<span class="st">'tidyverse'</span>, <span class="st">'plotly'</span>, <span class="st">'ggbraid'</span>,<span class="st">'ggplot2'</span>,<span class="st">'ggHoriPlot'</span>,<span class="st">'directlabels'</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(p <span class="cf">in</span> packages){</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(p,<span class="at">character.only =</span> T)){</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(p)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(p,<span class="at">character.only =</span> T)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: readxl</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tidyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lubridate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: timechange</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tidyverse</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ dplyr   1.0.10
✔ tibble  3.1.8      ✔ stringr 1.5.0 
✔ readr   2.1.3      ✔ forcats 0.5.2 
✔ purrr   1.0.0      
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ lubridate::as.difftime() masks base::as.difftime()
✖ lubridate::date()        masks base::date()
✖ dplyr::filter()          masks stats::filter()
✖ lubridate::intersect()   masks base::intersect()
✖ dplyr::lag()             masks stats::lag()
✖ lubridate::setdiff()     masks base::setdiff()
✖ lubridate::union()       masks base::union()
Loading required package: plotly


Attaching package: 'plotly'


The following object is masked from 'package:ggplot2':

    last_plot


The following object is masked from 'package:stats':

    filter


The following object is masked from 'package:graphics':

    layout


Loading required package: ggbraid

Loading required package: ggHoriPlot

Loading required package: directlabels</code></pre>
</div>
</div>
<p>First, we use the read_csv() function of the readr package to import the following dataset into the R environment:</p>
<ul>
<li><p>Import data</p></li>
<li><p>Export data</p></li>
<li><p>Country-Region mapping data</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"C:/Users/Eda/Desktop/MITB/Y3S1/ISSS608 Visual Analytics and Applications/edachang/ISSS608-VA1/Take-Home_Ex/Take-Home_Ex04/data/outputFile.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"T1"</span>, <span class="at">range =</span> <span class="st">"A1:AL120"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"C:/Users/Eda/Desktop/MITB/Y3S1/ISSS608 Visual Analytics and Applications/edachang/ISSS608-VA1/Take-Home_Ex/Take-Home_Ex04/data/outputFile.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"T2"</span>, <span class="at">range =</span> <span class="st">"A1:AL92"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"C:/Users/Eda/Desktop/MITB/Y3S1/ISSS608 Visual Analytics and Applications/edachang/ISSS608-VA1/Take-Home_Ex/Take-Home_Ex04/data/countries_region.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As we will only be looking at Jan 2020 to Dec 2022, we perform the following filters on the dataset.</p>
<ul>
<li><p>Filter only countries dataset (remove the first 7 rows)</p>
<p><img src="images/image-2125052474.png" class="img-fluid"></p></li>
<li><p>Remove the words in brackets (e.g.&nbsp;(Thousand Dollars)) from ‘Data Series’ column -&gt; Name it as ‘Countries’</p></li>
<li><p>Remove ‘Data Series’ column</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sgimport_ctry <span class="ot">&lt;-</span> T1 <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Countries =</span> <span class="fu">str_remove</span>(<span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                                <span class="st">" </span><span class="sc">\\</span><span class="st">(Thousand Dollars</span><span class="sc">\\</span><span class="st">)"</span>), </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>) </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>sgexport_ctry <span class="ot">&lt;-</span> T2 <span class="sc">%&gt;%</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Countries =</span> <span class="fu">str_remove</span>(<span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>, </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>                                <span class="st">" </span><span class="sc">\\</span><span class="st">(Thousand Dollars</span><span class="sc">\\</span><span class="st">)"</span>), </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p><em>Pivot_longer</em> to transpose dates into Year &amp; Month</p></li>
<li><p>Ensure that Values are numeric</p></li>
<li><p>Remove Year 2023 to ensure that the dataset runs from <strong>January 2020 to December 2022</strong></p></li>
</ul>
<div class="cell">

</div>
<ul>
<li><p>Left join both Import and Export dataset into one dataset</p></li>
<li><p>Manually clean the following countries to match with Regions</p></li>
<li><p>Create 2 columns - ‘Trade Balance’ and ‘Trade Volume’</p></li>
<li><p>Drop any na in ‘Trade Balance’ column</p></li>
<li><p>Remove ‘Other countries in Oceania’ for better comparison across countries instead of aggregated countries in oceania</p></li>
</ul>
<div class="cell">

</div>
<ul>
<li><p>Group by Month &amp; Year across all countries</p></li>
<li><p>Transpose Export &amp; Import into one column</p></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Month_Year'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<ul>
<li>Group by Countries &amp; Year across all countries</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Countries'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Find the <u>top 15 countries</u> for each region</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Asia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">America</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Europe</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Oceania</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<ol type="1">
<li>Left join regions to dataset that was grouped by Countries &amp; Year</li>
</ol>
<div class="cell">

</div>
<ol start="2" type="1">
<li>Filter region == “Asia”</li>
</ol>
<div class="cell">

</div>
<ol start="3" type="1">
<li>Group by Countries &amp; sum of Total Trade Volumes, sort by sum of Total Trade Volumes before taking the top 15 Countries</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
   Countries            sum_TV
   &lt;chr&gt;                 &lt;dbl&gt;
 1 China                 475. 
 2 Malaysia              385. 
 3 Taiwan                289. 
 4 Hong Kong             238. 
 5 Indonesia             184. 
 6 Korea                 172. 
 7 Japan                 169. 
 8 Thailand              109. 
 9 Vietnam                80.9
10 India                  77.4
11 Philippines            69.4
12 United Arab Emirates   64.9
13 Saudi Arabia           32.4
14 Cambodia               26.0
15 Qatar                  21.7</code></pre>
</div>
</div>
<section id="slopegraph" class="level5">
<h5 class="anchored" data-anchor-id="slopegraph">1. Slopegraph</h5>
<ol start="4" type="1">
<li>Manually filter 15 countries from previous table</li>
</ol>
<div class="cell">

</div>
</section>
<section id="export-import" class="level5">
<h5 class="anchored" data-anchor-id="export-import">2. Export-Import</h5>
<ol start="5" type="1">
<li>Left join region to countries</li>
</ol>
<div class="cell">

</div>
<ol start="6" type="1">
<li>Filter all countries in top 15 Asia countries</li>
</ol>
<div class="cell">

</div>
<ol start="7" type="1">
<li>Group by Month, Year &amp; Countries and sum both import &amp; export</li>
<li>Pivot both import &amp; export column into one</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Month_Year', 'Year'. You can override
using the `.groups` argument.</code></pre>
</div>
</div>
</section>
<section id="trade-balance" class="level5">
<h5 class="anchored" data-anchor-id="trade-balance">3. Trade Balance</h5>
<ol start="9" type="1">
<li>Filter only Asia countries in this table</li>
</ol>
<div class="cell">

</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<ol type="1">
<li>Filter region == “America”</li>
</ol>
<div class="cell">

</div>
<ol start="2" type="1">
<li>Group by Countries &amp; sum of Total Trade Volumes, sort by sum of Total Trade Volumes before taking the top 15 countries</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 2
   Countries     sum_TV
   &lt;chr&gt;          &lt;dbl&gt;
 1 United States 341.  
 2 Brazil         26.2 
 3 Mexico         16.6 
 4 Canada         11.5 
 5 Puerto Rico     3.92
 6 Guam            1.52
 7 Colombia        1.1 
 8 Argentina       1.06
 9 Chile           1.04
10 Ecuador         0.5 
11 Peru            0.44
12 Uruguay         0.26
13 Paraguay        0.03
14 Venezuela       0.02</code></pre>
</div>
</div>
<section id="slopegraph-1" class="level5">
<h5 class="anchored" data-anchor-id="slopegraph-1">1. Slopegraph</h5>
<ol start="3" type="1">
<li>Manually filter 15 countries from previous table</li>
</ol>
<div class="cell">

</div>
</section>
<section id="export-import-1" class="level5">
<h5 class="anchored" data-anchor-id="export-import-1">2. Export-Import</h5>
<ol start="4" type="1">
<li>Filter all countries in top 15 America countries</li>
</ol>
<div class="cell">

</div>
<ol start="5" type="1">
<li>Group by Month, Year &amp; Countries and sum both import &amp; export</li>
<li>Pivot both import &amp; export column into one</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Month_Year', 'Year'. You can override
using the `.groups` argument.</code></pre>
</div>
</div>
</section>
<section id="trade-balance-1" class="level5">
<h5 class="anchored" data-anchor-id="trade-balance-1">3. Trade Balance</h5>
<ol start="7" type="1">
<li>Filter only America countries in this table</li>
</ol>
<div class="cell">

</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<ol type="1">
<li>Filter region == “Europe”</li>
</ol>
<div class="cell">

</div>
<ol start="2" type="1">
<li>Group by Countries &amp; sum of Total Trade Volumes, sort by sum of Total Trade Volumes before taking the top 15 countries</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
   Countries      sum_TV
   &lt;chr&gt;           &lt;dbl&gt;
 1 Germany         68.1 
 2 France          63.2 
 3 Netherlands     54.1 
 4 Switzerland     47.1 
 5 United Kingdom  46.2 
 6 Belgium         27.7 
 7 Italy           22.8 
 8 Ireland          8.3 
 9 Malta            7.87
10 Spain            7.47
11 Sweden           6.24
12 Greece           5.6 
13 Czech Republic   4.6 
14 Austria          4.45
15 Denmark          3.85</code></pre>
</div>
</div>
<section id="slopegraph-2" class="level5">
<h5 class="anchored" data-anchor-id="slopegraph-2">1. Slopegraph</h5>
<ol start="3" type="1">
<li>Manually filter 15 countries from previous table</li>
</ol>
<div class="cell">

</div>
</section>
<section id="export-import-2" class="level5">
<h5 class="anchored" data-anchor-id="export-import-2">2. Export-Import</h5>
<ol start="4" type="1">
<li>Filter all countries in top 15 Europe countries</li>
</ol>
<div class="cell">

</div>
<ol start="5" type="1">
<li>Group by Month, Year &amp; Countries and sum both import &amp; export</li>
<li>Pivot both import &amp; export column into one</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Month_Year', 'Year'. You can override
using the `.groups` argument.</code></pre>
</div>
</div>
</section>
<section id="trade-balance-2" class="level5">
<h5 class="anchored" data-anchor-id="trade-balance-2">3. Trade Balance</h5>
<ol start="7" type="1">
<li>Filter only Europe countries in this table</li>
</ol>
<div class="cell">

</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<ol type="1">
<li>Filter region == “Oceania”</li>
</ol>
<div class="cell">

</div>
<ol start="2" type="1">
<li>Group by countries &amp; sum of Total Trade Volumes, sort by sum of Total Trade Volumes before taking the top 15 countries</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  Countries        sum_TV
  &lt;chr&gt;             &lt;dbl&gt;
1 Australia         80.2 
2 New Zealand       14.4 
3 Papua New Guinea   3.88
4 Fiji               1.36
5 Solomon Islands    0.24</code></pre>
</div>
</div>
<section id="slopegraph-3" class="level5">
<h5 class="anchored" data-anchor-id="slopegraph-3">1. Slopegraph</h5>
<ol start="3" type="1">
<li>Manually filter 15 countries from previous table</li>
</ol>
<div class="cell">

</div>
</section>
<section id="export-import-3" class="level5">
<h5 class="anchored" data-anchor-id="export-import-3">2. Export-Import</h5>
<ol start="4" type="1">
<li>Filter all countries in top 15 Oceania countries</li>
</ol>
<div class="cell">

</div>
<ol start="7" type="1">
<li>Group by Month, Year &amp; Countries and sum both import &amp; export</li>
<li>Pivot both import &amp; export column into one</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Month_Year', 'Year'. You can override
using the `.groups` argument.</code></pre>
</div>
</div>
</section>
<section id="trade-balance-3" class="level5">
<h5 class="anchored" data-anchor-id="trade-balance-3">3. Trade Balance</h5>
<ol start="9" type="1">
<li>Filter only Oceania countries in this table</li>
</ol>
<div class="cell">

</div>
</section>
</div>
</div>
</div>
</section>
<section id="visualization" class="level1">
<h1>4. Visualization</h1>
<section id="heatmap" class="level2">
<h2 class="anchored" data-anchor-id="heatmap">4.1 Heatmap</h2>
<p>In a calendar heatmap, colored cells show the number of events for each period of time. Heatmaps are used to identify seasonal patterns and anomalies in data and enable users to identify these patterns quickly. The heatmap uses colors and saturation to represent data values, so users can easily identify the high and low values based on color intensity in the heatmap.</p>
<div class="cell">

</div>
<p>Here, we are plotting the total trade volume over the years &amp; months.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><u>Insights</u></p>
<p>We observe the following:</p>
<ul>
<li><p>The top 3 lowest trade volume happened in Apr - Jun 2020 –&gt; This coincides with the economic slowdown in major economies and supply chain disruptions as well as the implementation of the circuit Breaker (CB) measures domestically from April to June 2020.</p></li>
<li><p>Singapore trade volume continue to increase from Mar 2021 onwards due to relaxation of covid-restrictions. This is observed by green (high trade volumes) from Mar - Sep 2022. In Oct 2022, there is a slowdown due to recession.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><u>Insights</u></p>
<p>We observe the following:</p>
<ul>
<li><p>Across all three years, Singapore exports more than it imports, which may be attributed to its strategic location.</p></li>
<li><p>Imports exceed exports in May 2022, resulting in a negative trade balance. The same pattern could be seen in April-August 2022 and October-December 2022. This could be because, as the United States enters a recession (Summer 2022 &amp; Oct 2022), Singapore is not immune, and the world economy enters a slump, with fewer exports. While Singapore continues to import, which is understandable given the country’s scarcity of natural resources.</p></li>
</ul>
</section>
<section id="trade-balance-of-singapore" class="level2">
<h2 class="anchored" data-anchor-id="trade-balance-of-singapore">4.2 Trade Balance of Singapore</h2>
<p>The difference between a country’s exports and imports for a certain period is known as the balance of trade (BOT). A country with a trade deficit imports more products and services than it exports in terms of value, whereas a country with a trade surplus exports more goods and services than it imports.</p>
<p>We utilize a horizon graph to show Singapore’s trade balance trend over the last three years, broken down by region. Each row represents a different country, with red representing a trade deficit and blue representing a trade surplus.</p>
<p><u>Insights</u></p>
<p>We can examine the main importers/exporters and trading activities of trading partners over time. We also observe that there is less trading activity with countries in America and Europe. Singapore primarily trades in Asia Pacific, possibly due to proximity.</p>
<ul>
<li><p>In Asia, we mostly export (blue) to Hong Kong, Indonesia, and Vietnam. We primarily import (red) from Malaysia and Taiwan.</p></li>
<li><p>In the United States, we mostly export (blue) to Guam and Puerto Rico. While we mostly import (red) from the United States, we also import from Brazil.</p></li>
<li><p>In Europe, we mostly export (blue) to the Netherlands and Greece. While we mostly import (red) from Italy, Spain, Sweden, Switzerland, and the United Kingdom. This could be because of free trade agreements with the European Union.</p></li>
<li><p>We mostly export to countries in Oceania.</p></li>
</ul>
<p>What is noteworthy about this analysis is that we observe&nbsp;that we often export to smaller countries while importing from larger countries. This could be due to Singapore’s many bilateral and regional FTAs including with Australia, China, Costa Rica, India, Japan, Jordan, New Zealand, Republic of Korea, Panama, Peru, Sri Lanka, European Union, United Kingdom and Turkey.</p>
<p>::: panel-tabset</p>
</section>
<section id="asia-1" class="level2">
<h2 class="anchored" data-anchor-id="asia-1">Asia</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using the `size` aesthetic in this geom was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` in the `default_aes` field and elsewhere instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="america-1" class="level2">
<h2 class="anchored" data-anchor-id="america-1">America</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="europe-1" class="level2">
<h2 class="anchored" data-anchor-id="europe-1">Europe</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="oceania-1" class="level2">
<h2 class="anchored" data-anchor-id="oceania-1">Oceania</h2>
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="export-import-graphs" class="level2">
<h2 class="anchored" data-anchor-id="export-import-graphs">4.3 Export-Import Graphs</h2>
<p>Plotting both export and import line into the same graph allows us to examine Singapore’s exports and imports easier over time. The user can easily determine whether each country’s trade activities are in surplus (green) or deficit (purple).</p>
<p><u>Insights</u></p>
<p>Singapore has experienced a trade surplus for the last three years, as shown in the green region, which is more than the purple area. The result is consistent with the trade summary from <a href="https://wits.worldbank.org/CountrySnapshot/en/SGP/textview#:~:text=Singapore%2C%20Imports%20of%20goods%20and,percentage%20of%20GDP%20is%20176.24%20%25.">World Bank.org</a>. This was also evident in the heatmap, which showed a low trade balance in May 2022. Trade activity falls sharply between February 2020 and December 2021. The drop in February 2020 was caused by Covid-19 shutdown restrictions and a standstill in global economic activity, during which the Singapore economy experienced both demand- and supply-side disruptions. Whereas the second drop in trade activity in December 2021 could be related to the uncertainty of Russia invading Ukraine. The decrease continued&nbsp;until February 2022, when the Russia-Ukraine war begin. On the other hand, imports and exports increased&nbsp;in March 2021 which could be due to easing of Covid restrictions.</p>
<p>Similar patterns can be found in different regions, as evidenced by the Trade Balance, where trade activity are lower in countries in America and higher in Asia. It’s worth noting that several countries had a mix of trade surpluses and trade deficits (e.g.&nbsp;Korea, China, US). For example, exports to China increased from July 2020 to April 2022, which might be linked to the pandemic and China’s strict zero covid policy, which delayed China’s opening and consequently lowered imports.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Overall</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Asia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">America</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Europe</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Oceania</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_braid()` using method = 'line'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_braid()` using method = 'line'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_braid()` using method = 'line'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_braid()` using method = 'line'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_braid()` using method = 'line'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="slopegraph-4" class="level2">
<h2 class="anchored" data-anchor-id="slopegraph-4">4.3 SlopeGraph</h2>
<p>The Slopegraph depicts the year-on-year trend of these countries’ total trade balance with Singapore. It is more intuitive for users as the slope-up/slope-down of the lines shows the increase/decrease in trade balance. Here we are only plotting the top 15 trade volume in each region.</p>
<p>In Asia, we can see that Hong Kong remains the top exporter of Singapore year on year (increasing trend). While Taiwan remains the top importer of Singapore year on year (decreasing trend).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Asia</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">America</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Europe</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Oceania</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Ex04_old_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="references" class="level1">
<h1>5. References</h1>
<p>https://nsgrantham.github.io/ggbraid/</p>
<p>https://www.mti.gov.sg/Trade/Multilateral-and-Regional-Forums</p>
<p>https://tradingeconomics.com/singapore/exports</p>
<p>https://www.singstat.gov.sg/modules/infographics/singapore-international-trade</p>
<p>https://www.enterprisesg.gov.sg/-/media/esg/files/media-centre/media-releases/2020/may-2020/monthly-trade-report—apr-2020.pdf?la=en</p>
<p>https://www.trade.gov/country-commercial-guides/singapore-trade-agreements#:~:text=Singapore%20also%20has%20many%20bilateral,Union%2C%20United%20Kingdom%20and%20Turkey.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb30" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-home Exercise 4"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Eda Chang"</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: false</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu"># The task</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>With the help of analysis visualisation techniques, we are to uncover the impact of COVID-19 and the global economic and political dynamics of 2022 on Singapore's bi-lateral trade (i.e. import, export and trade balance).</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1. Introduction</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>As Singaporeans, we have always been told that Singapore's trading success is due to its naturally deep harbor and strategic location, which connects India, China, and the Indonesian archipelago.</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>Furthermore, as a free trader with a small and open economy that is heavily reliant on trade, Singapore is more competitive than many of its neighbors in carrying out such activities.</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>Therefore, we hope to learn how the influence of COVID-19 and global economic and political dynamics will affect Singapore's bi-lateral commerce in this activity.</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2. Data</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>The dataset used for this experiment was obtained from <span class="co">[</span><span class="ot">Singstat.gov.sg</span><span class="co">](https://www.singstat.gov.sg/find-data/search-by-theme/trade-and-investment/merchandise-trade/latest-data)</span> and provides information on Goods Imports and Exports by Region / Market.</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>The study period will be from **January 2020 to December 2022** for the purposes of this exercise.</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3. Data Preparation</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>Ensure following packages are installed.</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("remotes")</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"nsgrantham/ggbraid"</span>)</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'readxl'</span>, <span class="st">'tidyr'</span>, <span class="st">'lubridate'</span>,<span class="st">'tidyverse'</span>, <span class="st">'plotly'</span>, <span class="st">'ggbraid'</span>,<span class="st">'ggplot2'</span>,<span class="st">'ggHoriPlot'</span>,<span class="st">'directlabels'</span>)</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(p <span class="cf">in</span> packages){</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(p,<span class="at">character.only =</span> T)){</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(p)</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(p,<span class="at">character.only =</span> T)</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>First, we use the read_csv() function of the readr package to import the following dataset into the R environment:</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Import data</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Export data</span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Country-Region mapping data</span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"C:/Users/Eda/Desktop/MITB/Y3S1/ISSS608 Visual Analytics and Applications/edachang/ISSS608-VA1/Take-Home_Ex/Take-Home_Ex04/data/outputFile.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"T1"</span>, <span class="at">range =</span> <span class="st">"A1:AL120"</span>)</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"C:/Users/Eda/Desktop/MITB/Y3S1/ISSS608 Visual Analytics and Applications/edachang/ISSS608-VA1/Take-Home_Ex/Take-Home_Ex04/data/outputFile.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"T2"</span>, <span class="at">range =</span> <span class="st">"A1:AL92"</span>)</span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>regions <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"C:/Users/Eda/Desktop/MITB/Y3S1/ISSS608 Visual Analytics and Applications/edachang/ISSS608-VA1/Take-Home_Ex/Take-Home_Ex04/data/countries_region.xlsx"</span>)</span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>As we will only be looking at Jan 2020 to Dec 2022, we perform the following filters on the dataset.</span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Filter only countries dataset (remove the first 7 rows)</span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>    <span class="al">![](images/image-2125052474.png)</span></span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Remove the words in brackets (e.g. (Thousand Dollars)) from 'Data Series' column -<span class="sc">\&gt;</span> Name it as 'Countries'</span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Remove 'Data Series' column</span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>sgimport_ctry <span class="ot">&lt;-</span> T1 <span class="sc">%&gt;%</span> </span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Countries =</span> <span class="fu">str_remove</span>(<span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>, </span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a>                                <span class="st">" </span><span class="sc">\\</span><span class="st">(Thousand Dollars</span><span class="sc">\\</span><span class="st">)"</span>), </span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>) </span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a>sgexport_ctry <span class="ot">&lt;-</span> T2 <span class="sc">%&gt;%</span> </span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Countries =</span> <span class="fu">str_remove</span>(<span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>, </span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a>                                <span class="st">" </span><span class="sc">\\</span><span class="st">(Thousand Dollars</span><span class="sc">\\</span><span class="st">)"</span>), </span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a>         <span class="at">.after =</span> <span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Data Series</span><span class="st">`</span>) </span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-117"><a href="#cb30-117" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>*Pivot_longer* to transpose dates into Year &amp; Month</span>
<span id="cb30-118"><a href="#cb30-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ensure that Values are numeric</span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Remove Year 2023 to ensure that the dataset runs from **January 2020 to December 2022**</span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-125"><a href="#cb30-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-126"><a href="#cb30-126" aria-hidden="true" tabindex="-1"></a>sgimport_cln <span class="ot">&lt;-</span> sgimport_ctry <span class="sc">%&gt;%</span> </span>
<span id="cb30-127"><a href="#cb30-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-128"><a href="#cb30-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span>Countries,</span>
<span id="cb30-129"><a href="#cb30-129" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>),</span>
<span id="cb30-130"><a href="#cb30-130" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">" "</span>,</span>
<span id="cb30-131"><a href="#cb30-131" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Import_SGD"</span></span>
<span id="cb30-132"><a href="#cb30-132" aria-hidden="true" tabindex="-1"></a>               ) <span class="sc">%&gt;%</span> </span>
<span id="cb30-133"><a href="#cb30-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-134"><a href="#cb30-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">factor</span>(Month, <span class="at">levels =</span> month.abb),</span>
<span id="cb30-135"><a href="#cb30-135" aria-hidden="true" tabindex="-1"></a>         <span class="at">Year =</span> <span class="fu">as.integer</span>(Year),</span>
<span id="cb30-136"><a href="#cb30-136" aria-hidden="true" tabindex="-1"></a>         <span class="at">Month_Year =</span> <span class="fu">make_date</span>(Year, Month),</span>
<span id="cb30-137"><a href="#cb30-137" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-138"><a href="#cb30-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-139"><a href="#cb30-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Import_SGD =</span> Import_SGD<span class="sc">*</span><span class="dv">1000</span>) </span>
<span id="cb30-140"><a href="#cb30-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-141"><a href="#cb30-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-142"><a href="#cb30-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-143"><a href="#cb30-143" aria-hidden="true" tabindex="-1"></a>sgexport_cln <span class="ot">&lt;-</span> sgexport_ctry <span class="sc">%&gt;%</span> </span>
<span id="cb30-144"><a href="#cb30-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-145"><a href="#cb30-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span>Countries,</span>
<span id="cb30-146"><a href="#cb30-146" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>),</span>
<span id="cb30-147"><a href="#cb30-147" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">" "</span>,</span>
<span id="cb30-148"><a href="#cb30-148" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Export_SGD"</span></span>
<span id="cb30-149"><a href="#cb30-149" aria-hidden="true" tabindex="-1"></a>               ) <span class="sc">%&gt;%</span> </span>
<span id="cb30-150"><a href="#cb30-150" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-151"><a href="#cb30-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">factor</span>(Month, <span class="at">levels =</span> month.abb),</span>
<span id="cb30-152"><a href="#cb30-152" aria-hidden="true" tabindex="-1"></a>         <span class="at">Year =</span> <span class="fu">as.integer</span>(Year),</span>
<span id="cb30-153"><a href="#cb30-153" aria-hidden="true" tabindex="-1"></a>         <span class="at">Month_Year =</span> <span class="fu">make_date</span>(Year, Month),</span>
<span id="cb30-154"><a href="#cb30-154" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-155"><a href="#cb30-155" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-156"><a href="#cb30-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Export_SGD =</span> Export_SGD<span class="sc">*</span><span class="dv">1000</span>) </span>
<span id="cb30-157"><a href="#cb30-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-158"><a href="#cb30-158" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert ImportValue column to numeric format</span></span>
<span id="cb30-159"><a href="#cb30-159" aria-hidden="true" tabindex="-1"></a>sgimport_cln<span class="sc">$</span><span class="st">'Import_SGD'</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sgimport_cln<span class="sc">$</span><span class="st">'Import_SGD'</span>)</span>
<span id="cb30-160"><a href="#cb30-160" aria-hidden="true" tabindex="-1"></a>sgexport_cln<span class="sc">$</span><span class="st">'Export_SGD'</span> <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sgexport_cln<span class="sc">$</span><span class="st">'Export_SGD'</span>)</span>
<span id="cb30-161"><a href="#cb30-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-162"><a href="#cb30-162" aria-hidden="true" tabindex="-1"></a>sgimport_cln<span class="ot">&lt;-</span><span class="fu">subset</span>(sgimport_cln, Year<span class="sc">!=</span><span class="st">"2023"</span>)</span>
<span id="cb30-163"><a href="#cb30-163" aria-hidden="true" tabindex="-1"></a>sgexport_cln<span class="ot">&lt;-</span><span class="fu">subset</span>(sgexport_cln, Year<span class="sc">!=</span><span class="st">"2023"</span>)</span>
<span id="cb30-164"><a href="#cb30-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-165"><a href="#cb30-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-166"><a href="#cb30-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-167"><a href="#cb30-167" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Left join both Import and Export dataset into one dataset</span>
<span id="cb30-168"><a href="#cb30-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-169"><a href="#cb30-169" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Manually clean the following countries to match with Regions</span>
<span id="cb30-170"><a href="#cb30-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-171"><a href="#cb30-171" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Create 2 columns - 'Trade Balance' and 'Trade Volume'</span>
<span id="cb30-172"><a href="#cb30-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-173"><a href="#cb30-173" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Drop any na in 'Trade Balance' column</span>
<span id="cb30-174"><a href="#cb30-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-175"><a href="#cb30-175" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Remove 'Other countries in Oceania' for better comparison across countries instead of aggregated countries in oceania</span>
<span id="cb30-176"><a href="#cb30-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-179"><a href="#cb30-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-180"><a href="#cb30-180" aria-hidden="true" tabindex="-1"></a>sgtrade_cln <span class="ot">&lt;-</span> sgimport_cln <span class="sc">%&gt;%</span> </span>
<span id="cb30-181"><a href="#cb30-181" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-182"><a href="#cb30-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sgexport_cln, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'Countries'</span> <span class="ot">=</span> <span class="st">'Countries'</span>, <span class="st">'Month_Year'</span> <span class="ot">=</span> <span class="st">'Month_Year'</span>, <span class="st">'Month'</span> <span class="ot">=</span> <span class="st">'Month'</span>, <span class="st">'Year'</span> <span class="ot">=</span> <span class="st">'Year'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-183"><a href="#cb30-183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-184"><a href="#cb30-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Countries =</span> <span class="fu">case_when</span>(Countries <span class="sc">==</span> <span class="st">"Germany, Federal Republic Of"</span> <span class="sc">~</span> <span class="st">"Germany"</span>,</span>
<span id="cb30-185"><a href="#cb30-185" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Vietnam, Socialist Republic Of"</span> <span class="sc">~</span> <span class="st">"Vietnam"</span>,</span>
<span id="cb30-186"><a href="#cb30-186" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Germany, Democratic Republic Of"</span> <span class="sc">~</span> <span class="st">"Germany"</span>,</span>
<span id="cb30-187"><a href="#cb30-187" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Maldives, Republic Of"</span> <span class="sc">~</span> <span class="st">"Maldives"</span>,</span>
<span id="cb30-188"><a href="#cb30-188" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Laos People's Democratic Republic"</span> <span class="sc">~</span> <span class="st">"Laos"</span>,</span>
<span id="cb30-189"><a href="#cb30-189" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Republic Of Korea"</span><span class="sc">~</span><span class="st">"Korea"</span>,</span>
<span id="cb30-190"><a href="#cb30-190" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Brunei Darussalam"</span><span class="sc">~</span><span class="st">"Brunei"</span>,</span>
<span id="cb30-191"><a href="#cb30-191" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Iran (Islamic Republic Of)"</span> <span class="sc">~</span> <span class="st">"Iran"</span>,</span>
<span id="cb30-192"><a href="#cb30-192" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Republic Of Korea"</span> <span class="sc">~</span> <span class="st">"South Korea"</span>,</span>
<span id="cb30-193"><a href="#cb30-193" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Mainland China"</span> <span class="sc">~</span> <span class="st">"China"</span>,</span>
<span id="cb30-194"><a href="#cb30-194" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Slovak Republic (Slovakia)"</span><span class="sc">~</span><span class="st">"Slovak Republic"</span>,</span>
<span id="cb30-195"><a href="#cb30-195" aria-hidden="true" tabindex="-1"></a>                               Countries <span class="sc">==</span> <span class="st">"Yemen Democratic"</span> <span class="sc">~</span> <span class="st">"Yemen"</span>,</span>
<span id="cb30-196"><a href="#cb30-196" aria-hidden="true" tabindex="-1"></a>                               <span class="cn">TRUE</span> <span class="sc">~</span> Countries)) <span class="sc">%&gt;%</span> </span>
<span id="cb30-197"><a href="#cb30-197" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-198"><a href="#cb30-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trade_Balance_SGD =</span> Export_SGD <span class="sc">-</span> Import_SGD,</span>
<span id="cb30-199"><a href="#cb30-199" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trade_Volumes_SGD =</span> Export_SGD <span class="sc">+</span> Import_SGD) </span>
<span id="cb30-200"><a href="#cb30-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-201"><a href="#cb30-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-202"><a href="#cb30-202" aria-hidden="true" tabindex="-1"></a>sgtrade_cln <span class="ot">&lt;-</span> sgtrade_cln <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(Trade_Balance_SGD)</span>
<span id="cb30-203"><a href="#cb30-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-204"><a href="#cb30-204" aria-hidden="true" tabindex="-1"></a>sgtrade_cln<span class="ot">&lt;-</span><span class="fu">subset</span>(sgtrade_cln, Countries<span class="sc">!=</span><span class="st">"Other Countries In Oceania"</span>)</span>
<span id="cb30-205"><a href="#cb30-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-206"><a href="#cb30-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-207"><a href="#cb30-207" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Group by Month &amp; Year across all countries</span>
<span id="cb30-208"><a href="#cb30-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-209"><a href="#cb30-209" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Transpose Export &amp; Import into one column</span>
<span id="cb30-210"><a href="#cb30-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-213"><a href="#cb30-213" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-214"><a href="#cb30-214" aria-hidden="true" tabindex="-1"></a>totalsgtrade <span class="ot">&lt;-</span> sgtrade_cln <span class="sc">%&gt;%</span> </span>
<span id="cb30-215"><a href="#cb30-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Month_Year, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb30-216"><a href="#cb30-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Import =</span> <span class="fu">sum</span>(Import_SGD),</span>
<span id="cb30-217"><a href="#cb30-217" aria-hidden="true" tabindex="-1"></a>            <span class="at">Export =</span> <span class="fu">sum</span>(Export_SGD))</span>
<span id="cb30-218"><a href="#cb30-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-219"><a href="#cb30-219" aria-hidden="true" tabindex="-1"></a>totalsgtrade_long <span class="ot">&lt;-</span> totalsgtrade <span class="sc">%&gt;%</span> </span>
<span id="cb30-220"><a href="#cb30-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(Month_Year, Year),</span>
<span id="cb30-221"><a href="#cb30-221" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Type"</span>,</span>
<span id="cb30-222"><a href="#cb30-222" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Values"</span>)</span>
<span id="cb30-223"><a href="#cb30-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-224"><a href="#cb30-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-225"><a href="#cb30-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-226"><a href="#cb30-226" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Group by Countries &amp; Year across all countries</span>
<span id="cb30-227"><a href="#cb30-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-230"><a href="#cb30-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-231"><a href="#cb30-231" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year <span class="ot">&lt;-</span> sgtrade_cln <span class="sc">%&gt;%</span> </span>
<span id="cb30-232"><a href="#cb30-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Countries, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb30-233"><a href="#cb30-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Total_Trade_Balance_BSGD =</span> <span class="fu">round</span>(<span class="fu">sum</span>(Trade_Balance_SGD)<span class="sc">/</span><span class="dv">1000000000</span>, <span class="dv">2</span>),</span>
<span id="cb30-234"><a href="#cb30-234" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total_Trade_Volumes_BSGD =</span> <span class="fu">round</span>(<span class="fu">sum</span>(Trade_Volumes_SGD)<span class="sc">/</span><span class="dv">1000000000</span>, <span class="dv">2</span>),</span>
<span id="cb30-235"><a href="#cb30-235" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total_Import_BSGD =</span> <span class="fu">round</span>(<span class="fu">sum</span>(Import_SGD)<span class="sc">/</span><span class="dv">1000000000</span>, <span class="dv">2</span>),</span>
<span id="cb30-236"><a href="#cb30-236" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total_Export_BSGD =</span> <span class="fu">round</span>(<span class="fu">sum</span>(Export_SGD)<span class="sc">/</span><span class="dv">1000000000</span>, <span class="dv">2</span>))</span>
<span id="cb30-237"><a href="#cb30-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-238"><a href="#cb30-238" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.character</span>(sgtrade_cln_year<span class="sc">$</span>Year)</span>
<span id="cb30-239"><a href="#cb30-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-240"><a href="#cb30-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-241"><a href="#cb30-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-242"><a href="#cb30-242" aria-hidden="true" tabindex="-1"></a>Find the <span class="co">[</span><span class="ot">top 15 countries</span><span class="co">]</span>{.underline} for each region</span>
<span id="cb30-243"><a href="#cb30-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-244"><a href="#cb30-244" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb30-245"><a href="#cb30-245" aria-hidden="true" tabindex="-1"></a><span class="fu">## Asia</span></span>
<span id="cb30-246"><a href="#cb30-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-247"><a href="#cb30-247" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Left join regions to dataset that was grouped by Countries &amp; Year</span>
<span id="cb30-248"><a href="#cb30-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-251"><a href="#cb30-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-252"><a href="#cb30-252" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year <span class="ot">&lt;-</span> sgtrade_cln_year <span class="sc">%&gt;%</span> </span>
<span id="cb30-253"><a href="#cb30-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(regions, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'Countries'</span> <span class="ot">=</span> <span class="st">'Country'</span>))</span>
<span id="cb30-254"><a href="#cb30-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-255"><a href="#cb30-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-256"><a href="#cb30-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-257"><a href="#cb30-257" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Filter region == "Asia"</span>
<span id="cb30-258"><a href="#cb30-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-261"><a href="#cb30-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-262"><a href="#cb30-262" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_Asia <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_year, Region<span class="sc">==</span><span class="st">"Asia"</span>)</span>
<span id="cb30-263"><a href="#cb30-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-264"><a href="#cb30-264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-265"><a href="#cb30-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-266"><a href="#cb30-266" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Group by Countries &amp; sum of Total Trade Volumes, sort by sum of Total Trade Volumes before taking the top 15 Countries</span>
<span id="cb30-267"><a href="#cb30-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-270"><a href="#cb30-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-271"><a href="#cb30-271" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_Asia_top15 <span class="ot">&lt;-</span> sgtrade_cln_year_Asia <span class="sc">%&gt;%</span></span>
<span id="cb30-272"><a href="#cb30-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Countries, Total_Trade_Volumes_BSGD) <span class="sc">%&gt;%</span></span>
<span id="cb30-273"><a href="#cb30-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Countries) <span class="sc">%&gt;%</span></span>
<span id="cb30-274"><a href="#cb30-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_TV =</span> <span class="fu">sum</span>(Total_Trade_Volumes_BSGD),</span>
<span id="cb30-275"><a href="#cb30-275" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-276"><a href="#cb30-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(sum_TV)) <span class="sc">%&gt;%</span></span>
<span id="cb30-277"><a href="#cb30-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb30-278"><a href="#cb30-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-279"><a href="#cb30-279" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_Asia_top15</span>
<span id="cb30-280"><a href="#cb30-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-281"><a href="#cb30-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-282"><a href="#cb30-282" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 1. Slopegraph</span></span>
<span id="cb30-283"><a href="#cb30-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-284"><a href="#cb30-284" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Manually filter 15 countries from previous table</span>
<span id="cb30-285"><a href="#cb30-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-288"><a href="#cb30-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-289"><a href="#cb30-289" aria-hidden="true" tabindex="-1"></a>top_15_asiacountries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"China"</span>,<span class="st">"Malaysia"</span>,<span class="st">"Taiwan"</span>,<span class="st">"Hong Kong"</span>,<span class="st">"Indonesia"</span>,<span class="st">"Korea"</span>,<span class="st">"Japan"</span>,<span class="st">"Thailand"</span>,<span class="st">"Vietnam"</span>,<span class="st">"India"</span>,<span class="st">"Philippines"</span>,<span class="st">"United Arab Emirates"</span>,<span class="st">"Saudi Arabia"</span>,<span class="st">"Cambodia"</span>,<span class="st">"Qatar"</span>)</span>
<span id="cb30-290"><a href="#cb30-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-291"><a href="#cb30-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-292"><a href="#cb30-292" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_Asia <span class="ot">&lt;-</span> sgtrade_cln_year_Asia <span class="sc">%&gt;%</span></span>
<span id="cb30-293"><a href="#cb30-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Countries <span class="sc">%in%</span> top_15_asiacountries)</span>
<span id="cb30-294"><a href="#cb30-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-295"><a href="#cb30-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-296"><a href="#cb30-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-297"><a href="#cb30-297" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 2. Export-Import</span></span>
<span id="cb30-298"><a href="#cb30-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-299"><a href="#cb30-299" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Left join region to countries</span>
<span id="cb30-300"><a href="#cb30-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-303"><a href="#cb30-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-304"><a href="#cb30-304" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_region <span class="ot">&lt;-</span> sgtrade_cln <span class="sc">%&gt;%</span> </span>
<span id="cb30-305"><a href="#cb30-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(regions, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'Countries'</span> <span class="ot">=</span> <span class="st">'Country'</span>))</span>
<span id="cb30-306"><a href="#cb30-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-307"><a href="#cb30-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-308"><a href="#cb30-308" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Filter all countries in top 15 Asia countries</span>
<span id="cb30-309"><a href="#cb30-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-312"><a href="#cb30-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-313"><a href="#cb30-313" aria-hidden="true" tabindex="-1"></a>totalsgtrade_asia <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_region, Region<span class="sc">==</span><span class="st">"Asia"</span>)</span>
<span id="cb30-314"><a href="#cb30-314" aria-hidden="true" tabindex="-1"></a>totalsgtrade_asia <span class="ot">&lt;-</span> totalsgtrade_asia <span class="sc">%&gt;%</span></span>
<span id="cb30-315"><a href="#cb30-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Countries <span class="sc">%in%</span> top_15_asiacountries)</span>
<span id="cb30-316"><a href="#cb30-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-317"><a href="#cb30-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-318"><a href="#cb30-318" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Group by Month, Year &amp; Countries and sum both import &amp; export</span>
<span id="cb30-319"><a href="#cb30-319" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Pivot both import &amp; export column into one</span>
<span id="cb30-320"><a href="#cb30-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-323"><a href="#cb30-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-324"><a href="#cb30-324" aria-hidden="true" tabindex="-1"></a>totalsgtrade_asia <span class="ot">&lt;-</span> totalsgtrade_asia <span class="sc">%&gt;%</span> </span>
<span id="cb30-325"><a href="#cb30-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Month_Year, Year, Countries) <span class="sc">%&gt;%</span> </span>
<span id="cb30-326"><a href="#cb30-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Import =</span> <span class="fu">sum</span>(Import_SGD),</span>
<span id="cb30-327"><a href="#cb30-327" aria-hidden="true" tabindex="-1"></a>            <span class="at">Export =</span> <span class="fu">sum</span>(Export_SGD))</span>
<span id="cb30-328"><a href="#cb30-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-329"><a href="#cb30-329" aria-hidden="true" tabindex="-1"></a>totalsgtrade_long_asia <span class="ot">&lt;-</span> totalsgtrade_asia <span class="sc">%&gt;%</span> </span>
<span id="cb30-330"><a href="#cb30-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(Month_Year, Year, Countries),</span>
<span id="cb30-331"><a href="#cb30-331" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Type"</span>,</span>
<span id="cb30-332"><a href="#cb30-332" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Values"</span>)</span>
<span id="cb30-333"><a href="#cb30-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-334"><a href="#cb30-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-335"><a href="#cb30-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-336"><a href="#cb30-336" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 3. Trade Balance</span></span>
<span id="cb30-337"><a href="#cb30-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-338"><a href="#cb30-338" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>Filter only Asia countries in this table</span>
<span id="cb30-339"><a href="#cb30-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-342"><a href="#cb30-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-343"><a href="#cb30-343" aria-hidden="true" tabindex="-1"></a>totalsgtrade_asia_tradebalance <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_region, Region<span class="sc">==</span><span class="st">"Asia"</span>)</span>
<span id="cb30-344"><a href="#cb30-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-345"><a href="#cb30-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-346"><a href="#cb30-346" aria-hidden="true" tabindex="-1"></a><span class="fu">## America</span></span>
<span id="cb30-347"><a href="#cb30-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-348"><a href="#cb30-348" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Filter region == "America"</span>
<span id="cb30-349"><a href="#cb30-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-352"><a href="#cb30-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-353"><a href="#cb30-353" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_America <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_year, Region<span class="sc">==</span><span class="st">"America"</span>)</span>
<span id="cb30-354"><a href="#cb30-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-355"><a href="#cb30-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-356"><a href="#cb30-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-357"><a href="#cb30-357" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Group by Countries &amp; sum of Total Trade Volumes, sort by sum of Total Trade Volumes before taking the top 15 countries</span>
<span id="cb30-358"><a href="#cb30-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-361"><a href="#cb30-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-362"><a href="#cb30-362" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_America_top15 <span class="ot">&lt;-</span> sgtrade_cln_year_America <span class="sc">%&gt;%</span></span>
<span id="cb30-363"><a href="#cb30-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Countries, Total_Trade_Volumes_BSGD) <span class="sc">%&gt;%</span></span>
<span id="cb30-364"><a href="#cb30-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Countries) <span class="sc">%&gt;%</span></span>
<span id="cb30-365"><a href="#cb30-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_TV =</span> <span class="fu">sum</span>(Total_Trade_Volumes_BSGD),</span>
<span id="cb30-366"><a href="#cb30-366" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-367"><a href="#cb30-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(sum_TV)) <span class="sc">%&gt;%</span></span>
<span id="cb30-368"><a href="#cb30-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb30-369"><a href="#cb30-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-370"><a href="#cb30-370" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_America_top15</span>
<span id="cb30-371"><a href="#cb30-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-372"><a href="#cb30-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-373"><a href="#cb30-373" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 1. Slopegraph</span></span>
<span id="cb30-374"><a href="#cb30-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-375"><a href="#cb30-375" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Manually filter 15 countries from previous table</span>
<span id="cb30-376"><a href="#cb30-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-379"><a href="#cb30-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-380"><a href="#cb30-380" aria-hidden="true" tabindex="-1"></a>top_15_americacountries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"United States"</span>,<span class="st">"Brazil"</span>,<span class="st">"Mexico"</span>,<span class="st">"Canada"</span>,<span class="st">"Puerto Rico"</span>,<span class="st">"Guam"</span>,<span class="st">"Colombia"</span>,<span class="st">"Argentina"</span>,<span class="st">"Chile"</span>,<span class="st">"Ecuador"</span>,<span class="st">"Peru"</span>,<span class="st">"Uruguay"</span>,<span class="st">"Paraguay"</span>,<span class="st">"Venezuela"</span>)</span>
<span id="cb30-381"><a href="#cb30-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-382"><a href="#cb30-382" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_America <span class="ot">&lt;-</span> sgtrade_cln_year_America <span class="sc">%&gt;%</span></span>
<span id="cb30-383"><a href="#cb30-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Countries <span class="sc">%in%</span> top_15_americacountries)</span>
<span id="cb30-384"><a href="#cb30-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-385"><a href="#cb30-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-386"><a href="#cb30-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-387"><a href="#cb30-387" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 2. Export-Import</span></span>
<span id="cb30-388"><a href="#cb30-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-389"><a href="#cb30-389" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Filter all countries in top 15 America countries</span>
<span id="cb30-390"><a href="#cb30-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-393"><a href="#cb30-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-394"><a href="#cb30-394" aria-hidden="true" tabindex="-1"></a>totalsgtrade_america <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_region, Region<span class="sc">==</span><span class="st">"America"</span>)</span>
<span id="cb30-395"><a href="#cb30-395" aria-hidden="true" tabindex="-1"></a>totalsgtrade_america <span class="ot">&lt;-</span> totalsgtrade_america <span class="sc">%&gt;%</span></span>
<span id="cb30-396"><a href="#cb30-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Countries <span class="sc">%in%</span> top_15_americacountries)</span>
<span id="cb30-397"><a href="#cb30-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-398"><a href="#cb30-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-399"><a href="#cb30-399" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Group by Month, Year &amp; Countries and sum both import &amp; export</span>
<span id="cb30-400"><a href="#cb30-400" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Pivot both import &amp; export column into one</span>
<span id="cb30-401"><a href="#cb30-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-404"><a href="#cb30-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-405"><a href="#cb30-405" aria-hidden="true" tabindex="-1"></a>totalsgtrade_america <span class="ot">&lt;-</span> totalsgtrade_america <span class="sc">%&gt;%</span> </span>
<span id="cb30-406"><a href="#cb30-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Month_Year, Year, Countries) <span class="sc">%&gt;%</span> </span>
<span id="cb30-407"><a href="#cb30-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Import =</span> <span class="fu">sum</span>(Import_SGD),</span>
<span id="cb30-408"><a href="#cb30-408" aria-hidden="true" tabindex="-1"></a>            <span class="at">Export =</span> <span class="fu">sum</span>(Export_SGD))</span>
<span id="cb30-409"><a href="#cb30-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-410"><a href="#cb30-410" aria-hidden="true" tabindex="-1"></a>totalsgtrade_long_america <span class="ot">&lt;-</span> totalsgtrade_america <span class="sc">%&gt;%</span> </span>
<span id="cb30-411"><a href="#cb30-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(Month_Year, Year, Countries),</span>
<span id="cb30-412"><a href="#cb30-412" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Type"</span>,</span>
<span id="cb30-413"><a href="#cb30-413" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Values"</span>)</span>
<span id="cb30-414"><a href="#cb30-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-415"><a href="#cb30-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-416"><a href="#cb30-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-417"><a href="#cb30-417" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 3. Trade Balance</span></span>
<span id="cb30-418"><a href="#cb30-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-419"><a href="#cb30-419" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Filter only America countries in this table</span>
<span id="cb30-420"><a href="#cb30-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-423"><a href="#cb30-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-424"><a href="#cb30-424" aria-hidden="true" tabindex="-1"></a>totalsgtrade_america_tradebalance <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_region, Region<span class="sc">==</span><span class="st">"America"</span>)</span>
<span id="cb30-425"><a href="#cb30-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-426"><a href="#cb30-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-427"><a href="#cb30-427" aria-hidden="true" tabindex="-1"></a><span class="fu">## Europe</span></span>
<span id="cb30-428"><a href="#cb30-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-429"><a href="#cb30-429" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Filter region == "Europe"</span>
<span id="cb30-430"><a href="#cb30-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-433"><a href="#cb30-433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-434"><a href="#cb30-434" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_Europe <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_year, Region<span class="sc">==</span><span class="st">"Europe"</span>)</span>
<span id="cb30-435"><a href="#cb30-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-436"><a href="#cb30-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-437"><a href="#cb30-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-438"><a href="#cb30-438" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Group by Countries &amp; sum of Total Trade Volumes, sort by sum of Total Trade Volumes before taking the top 15 countries</span>
<span id="cb30-439"><a href="#cb30-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-442"><a href="#cb30-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-443"><a href="#cb30-443" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_Europe_top15 <span class="ot">&lt;-</span> sgtrade_cln_year_Europe <span class="sc">%&gt;%</span></span>
<span id="cb30-444"><a href="#cb30-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Countries, Total_Trade_Volumes_BSGD) <span class="sc">%&gt;%</span></span>
<span id="cb30-445"><a href="#cb30-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Countries) <span class="sc">%&gt;%</span></span>
<span id="cb30-446"><a href="#cb30-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_TV =</span> <span class="fu">sum</span>(Total_Trade_Volumes_BSGD),</span>
<span id="cb30-447"><a href="#cb30-447" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-448"><a href="#cb30-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(sum_TV)) <span class="sc">%&gt;%</span></span>
<span id="cb30-449"><a href="#cb30-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb30-450"><a href="#cb30-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-451"><a href="#cb30-451" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_Europe_top15</span>
<span id="cb30-452"><a href="#cb30-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-453"><a href="#cb30-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-454"><a href="#cb30-454" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 1. Slopegraph</span></span>
<span id="cb30-455"><a href="#cb30-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-456"><a href="#cb30-456" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Manually filter 15 countries from previous table</span>
<span id="cb30-457"><a href="#cb30-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-460"><a href="#cb30-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-461"><a href="#cb30-461" aria-hidden="true" tabindex="-1"></a>top_15_europecountries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Germany"</span>, <span class="st">"France"</span>, <span class="st">"Netherlands"</span>, <span class="st">"Switzerland"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"Belgium"</span>, <span class="st">"Italy"</span>, <span class="st">"Ireland"</span>, <span class="st">"Malta"</span>, <span class="st">"Spain"</span>,<span class="st">"Sweden"</span>,<span class="st">"Greece"</span>,<span class="st">"Czech Republic"</span>,<span class="st">"Austria"</span>,<span class="st">"Denmark"</span>)</span>
<span id="cb30-462"><a href="#cb30-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-463"><a href="#cb30-463" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_Europe <span class="ot">&lt;-</span> sgtrade_cln_year_Europe <span class="sc">%&gt;%</span></span>
<span id="cb30-464"><a href="#cb30-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Countries <span class="sc">%in%</span> top_15_europecountries)</span>
<span id="cb30-465"><a href="#cb30-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-466"><a href="#cb30-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-467"><a href="#cb30-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-468"><a href="#cb30-468" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 2. Export-Import</span></span>
<span id="cb30-469"><a href="#cb30-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-470"><a href="#cb30-470" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Filter all countries in top 15 Europe countries</span>
<span id="cb30-471"><a href="#cb30-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-474"><a href="#cb30-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-475"><a href="#cb30-475" aria-hidden="true" tabindex="-1"></a>totalsgtrade_europe <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_region, Region<span class="sc">==</span><span class="st">"Europe"</span>)</span>
<span id="cb30-476"><a href="#cb30-476" aria-hidden="true" tabindex="-1"></a>totalsgtrade_europe <span class="ot">&lt;-</span> totalsgtrade_europe <span class="sc">%&gt;%</span></span>
<span id="cb30-477"><a href="#cb30-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Countries <span class="sc">%in%</span> top_15_europecountries)</span>
<span id="cb30-478"><a href="#cb30-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-479"><a href="#cb30-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-480"><a href="#cb30-480" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Group by Month, Year &amp; Countries and sum both import &amp; export</span>
<span id="cb30-481"><a href="#cb30-481" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Pivot both import &amp; export column into one</span>
<span id="cb30-482"><a href="#cb30-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-485"><a href="#cb30-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-486"><a href="#cb30-486" aria-hidden="true" tabindex="-1"></a>totalsgtrade_europe <span class="ot">&lt;-</span> totalsgtrade_europe <span class="sc">%&gt;%</span> </span>
<span id="cb30-487"><a href="#cb30-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Month_Year, Year, Countries) <span class="sc">%&gt;%</span> </span>
<span id="cb30-488"><a href="#cb30-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Import =</span> <span class="fu">sum</span>(Import_SGD),</span>
<span id="cb30-489"><a href="#cb30-489" aria-hidden="true" tabindex="-1"></a>            <span class="at">Export =</span> <span class="fu">sum</span>(Export_SGD))</span>
<span id="cb30-490"><a href="#cb30-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-491"><a href="#cb30-491" aria-hidden="true" tabindex="-1"></a>totalsgtrade_long_europe <span class="ot">&lt;-</span> totalsgtrade_europe <span class="sc">%&gt;%</span> </span>
<span id="cb30-492"><a href="#cb30-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(Month_Year, Year, Countries),</span>
<span id="cb30-493"><a href="#cb30-493" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Type"</span>,</span>
<span id="cb30-494"><a href="#cb30-494" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Values"</span>)</span>
<span id="cb30-495"><a href="#cb30-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-496"><a href="#cb30-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-497"><a href="#cb30-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-498"><a href="#cb30-498" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 3. Trade Balance</span></span>
<span id="cb30-499"><a href="#cb30-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-500"><a href="#cb30-500" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Filter only Europe countries in this table</span>
<span id="cb30-501"><a href="#cb30-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-504"><a href="#cb30-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-505"><a href="#cb30-505" aria-hidden="true" tabindex="-1"></a>totalsgtrade_europe_tradebalance <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_region, Region<span class="sc">==</span><span class="st">"Europe"</span>)</span>
<span id="cb30-506"><a href="#cb30-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-507"><a href="#cb30-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-508"><a href="#cb30-508" aria-hidden="true" tabindex="-1"></a><span class="fu">## Oceania</span></span>
<span id="cb30-509"><a href="#cb30-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-510"><a href="#cb30-510" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Filter region == "Oceania"</span>
<span id="cb30-511"><a href="#cb30-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-514"><a href="#cb30-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-515"><a href="#cb30-515" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_oceania <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_year, Region<span class="sc">==</span><span class="st">"Oceania"</span>)</span>
<span id="cb30-516"><a href="#cb30-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-517"><a href="#cb30-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-518"><a href="#cb30-518" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Group by countries &amp; sum of Total Trade Volumes, sort by sum of Total Trade Volumes before taking the top 15 countries</span>
<span id="cb30-519"><a href="#cb30-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-522"><a href="#cb30-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-523"><a href="#cb30-523" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_oceania_top15 <span class="ot">&lt;-</span> sgtrade_cln_year_oceania <span class="sc">%&gt;%</span></span>
<span id="cb30-524"><a href="#cb30-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Countries, Total_Trade_Volumes_BSGD) <span class="sc">%&gt;%</span></span>
<span id="cb30-525"><a href="#cb30-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Countries) <span class="sc">%&gt;%</span></span>
<span id="cb30-526"><a href="#cb30-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum_TV =</span> <span class="fu">sum</span>(Total_Trade_Volumes_BSGD),</span>
<span id="cb30-527"><a href="#cb30-527" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-528"><a href="#cb30-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(sum_TV)) <span class="sc">%&gt;%</span></span>
<span id="cb30-529"><a href="#cb30-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">15</span>)</span>
<span id="cb30-530"><a href="#cb30-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-531"><a href="#cb30-531" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_oceania_top15</span>
<span id="cb30-532"><a href="#cb30-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-533"><a href="#cb30-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-534"><a href="#cb30-534" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 1. Slopegraph</span></span>
<span id="cb30-535"><a href="#cb30-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-536"><a href="#cb30-536" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Manually filter 15 countries from previous table</span>
<span id="cb30-537"><a href="#cb30-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-540"><a href="#cb30-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-541"><a href="#cb30-541" aria-hidden="true" tabindex="-1"></a>top_15_oceaniacountries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Australia"</span>,<span class="st">"New Zealand"</span>,<span class="st">"Papua New Guinea"</span>,<span class="st">"Fiji"</span>,<span class="st">"Solomon Islands"</span>)</span>
<span id="cb30-542"><a href="#cb30-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-543"><a href="#cb30-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-544"><a href="#cb30-544" aria-hidden="true" tabindex="-1"></a>sgtrade_cln_year_oceania <span class="ot">&lt;-</span> sgtrade_cln_year_oceania <span class="sc">%&gt;%</span></span>
<span id="cb30-545"><a href="#cb30-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Countries <span class="sc">%in%</span> top_15_oceaniacountries)</span>
<span id="cb30-546"><a href="#cb30-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-547"><a href="#cb30-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-548"><a href="#cb30-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-549"><a href="#cb30-549" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 2. Export-Import</span></span>
<span id="cb30-550"><a href="#cb30-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-551"><a href="#cb30-551" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Filter all countries in top 15 Oceania countries</span>
<span id="cb30-552"><a href="#cb30-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-555"><a href="#cb30-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-556"><a href="#cb30-556" aria-hidden="true" tabindex="-1"></a>totalsgtrade_oceania <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_region, Region<span class="sc">==</span><span class="st">"Oceania"</span>)</span>
<span id="cb30-557"><a href="#cb30-557" aria-hidden="true" tabindex="-1"></a>totalsgtrade_oceania <span class="ot">&lt;-</span> totalsgtrade_oceania <span class="sc">%&gt;%</span></span>
<span id="cb30-558"><a href="#cb30-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Countries <span class="sc">%in%</span> top_15_oceaniacountries)</span>
<span id="cb30-559"><a href="#cb30-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-560"><a href="#cb30-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-561"><a href="#cb30-561" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>Group by Month, Year &amp; Countries and sum both import &amp; export</span>
<span id="cb30-562"><a href="#cb30-562" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>Pivot both import &amp; export column into one</span>
<span id="cb30-563"><a href="#cb30-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-566"><a href="#cb30-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-567"><a href="#cb30-567" aria-hidden="true" tabindex="-1"></a>totalsgtrade_oceania <span class="ot">&lt;-</span> totalsgtrade_oceania <span class="sc">%&gt;%</span> </span>
<span id="cb30-568"><a href="#cb30-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Month_Year, Year, Countries) <span class="sc">%&gt;%</span> </span>
<span id="cb30-569"><a href="#cb30-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Import =</span> <span class="fu">sum</span>(Import_SGD),</span>
<span id="cb30-570"><a href="#cb30-570" aria-hidden="true" tabindex="-1"></a>            <span class="at">Export =</span> <span class="fu">sum</span>(Export_SGD))</span>
<span id="cb30-571"><a href="#cb30-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-572"><a href="#cb30-572" aria-hidden="true" tabindex="-1"></a>totalsgtrade_long_oceania <span class="ot">&lt;-</span> totalsgtrade_oceania <span class="sc">%&gt;%</span> </span>
<span id="cb30-573"><a href="#cb30-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(Month_Year, Year, Countries),</span>
<span id="cb30-574"><a href="#cb30-574" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Type"</span>,</span>
<span id="cb30-575"><a href="#cb30-575" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Values"</span>)</span>
<span id="cb30-576"><a href="#cb30-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-577"><a href="#cb30-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-578"><a href="#cb30-578" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 3. Trade Balance</span></span>
<span id="cb30-579"><a href="#cb30-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-580"><a href="#cb30-580" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>Filter only Oceania countries in this table</span>
<span id="cb30-581"><a href="#cb30-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-584"><a href="#cb30-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-585"><a href="#cb30-585" aria-hidden="true" tabindex="-1"></a>totalsgtrade_oceania_tradebalance <span class="ot">&lt;-</span> <span class="fu">subset</span>(sgtrade_cln_region, Region<span class="sc">==</span><span class="st">"Oceania"</span>)</span>
<span id="cb30-586"><a href="#cb30-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-587"><a href="#cb30-587" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-588"><a href="#cb30-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-589"><a href="#cb30-589" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4. Visualization</span></span>
<span id="cb30-590"><a href="#cb30-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-591"><a href="#cb30-591" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1 Heatmap</span></span>
<span id="cb30-592"><a href="#cb30-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-593"><a href="#cb30-593" aria-hidden="true" tabindex="-1"></a>In a calendar heatmap, colored cells show the number of events for each period of time. Heatmaps are used to identify seasonal patterns and anomalies in data and enable users to identify these patterns quickly. The heatmap uses colors and saturation to represent data values, so users can easily identify the high and low values based on color intensity in the heatmap.</span>
<span id="cb30-594"><a href="#cb30-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-597"><a href="#cb30-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-598"><a href="#cb30-598" aria-hidden="true" tabindex="-1"></a>totalsgtrade_calmap <span class="ot">&lt;-</span> totalsgtrade <span class="sc">%&gt;%</span> </span>
<span id="cb30-599"><a href="#cb30-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">factor</span>(<span class="fu">format</span>(Month_Year,<span class="st">"%b"</span>)), <span class="at">.after =</span> Year) <span class="sc">%&gt;%</span> </span>
<span id="cb30-600"><a href="#cb30-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trade_Balance =</span> (Export <span class="sc">-</span> Import)<span class="sc">/</span><span class="dv">1000000000</span>,</span>
<span id="cb30-601"><a href="#cb30-601" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trade_Volumes =</span> (Export <span class="sc">+</span> Import)<span class="sc">/</span><span class="dv">1000000000</span>)</span>
<span id="cb30-602"><a href="#cb30-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-603"><a href="#cb30-603" aria-hidden="true" tabindex="-1"></a>sgtrade_calmap <span class="ot">&lt;-</span> sgtrade_cln <span class="sc">%&gt;%</span> </span>
<span id="cb30-604"><a href="#cb30-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Trade_Balance =</span> Trade_Balance_SGD<span class="sc">/</span><span class="dv">1000000000</span>)</span>
<span id="cb30-605"><a href="#cb30-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-606"><a href="#cb30-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-607"><a href="#cb30-607" aria-hidden="true" tabindex="-1"></a>sgtrade_calmap<span class="sc">$</span>Countries <span class="ot">&lt;-</span> <span class="fu">fct_reorder</span>(sgtrade_calmap<span class="sc">$</span>Countries, sgtrade_calmap<span class="sc">$</span>Trade_Volumes_SGD, <span class="at">.desc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-608"><a href="#cb30-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-609"><a href="#cb30-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-610"><a href="#cb30-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-611"><a href="#cb30-611" aria-hidden="true" tabindex="-1"></a>Here, we are plotting the total trade volume over the years &amp; months.</span>
<span id="cb30-612"><a href="#cb30-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-615"><a href="#cb30-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-616"><a href="#cb30-616" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the base plot</span></span>
<span id="cb30-617"><a href="#cb30-617" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(totalsgtrade_calmap <span class="sc">%&gt;%</span> </span>
<span id="cb30-618"><a href="#cb30-618" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">factor</span>(Year, <span class="at">levels =</span><span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">2021</span>,<span class="dv">2020</span>))), </span>
<span id="cb30-619"><a href="#cb30-619" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Month, </span>
<span id="cb30-620"><a href="#cb30-620" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Year, </span>
<span id="cb30-621"><a href="#cb30-621" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> Trade_Volumes)) <span class="sc">+</span> </span>
<span id="cb30-622"><a href="#cb30-622" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-623"><a href="#cb30-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb30-624"><a href="#cb30-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-625"><a href="#cb30-625" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the colors for the main plot</span></span>
<span id="cb30-626"><a href="#cb30-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">name =</span> <span class="st">"Trade Volume (Billions SGD)"</span>,</span>
<span id="cb30-627"><a href="#cb30-627" aria-hidden="true" tabindex="-1"></a>                    <span class="at">low =</span> <span class="st">"#fc8d59"</span>, </span>
<span id="cb30-628"><a href="#cb30-628" aria-hidden="true" tabindex="-1"></a>                    <span class="at">high =</span> <span class="st">"#5ab4ac"</span>) <span class="sc">+</span></span>
<span id="cb30-629"><a href="#cb30-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-630"><a href="#cb30-630" aria-hidden="true" tabindex="-1"></a><span class="co">#Ensure equal scales for both coordinates  </span></span>
<span id="cb30-631"><a href="#cb30-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb30-632"><a href="#cb30-632" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-633"><a href="#cb30-633" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the theme to remove the x and y axis</span></span>
<span id="cb30-634"><a href="#cb30-634" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-635"><a href="#cb30-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-636"><a href="#cb30-636" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb30-637"><a href="#cb30-637" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb30-638"><a href="#cb30-638" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb30-639"><a href="#cb30-639" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-640"><a href="#cb30-640" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding title, subtitle, and captions</span></span>
<span id="cb30-641"><a href="#cb30-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb30-642"><a href="#cb30-642" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb30-643"><a href="#cb30-643" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Singapore Trade Volume by calendar months, 2020-2022"</span>,</span>
<span id="cb30-644"><a href="#cb30-644" aria-hidden="true" tabindex="-1"></a>     <span class="at">caption =</span> <span class="st">"Department of Statistics, Singapore"</span>) </span>
<span id="cb30-645"><a href="#cb30-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-646"><a href="#cb30-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-647"><a href="#cb30-647" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Insights</span><span class="co">]</span>{.underline}</span>
<span id="cb30-648"><a href="#cb30-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-649"><a href="#cb30-649" aria-hidden="true" tabindex="-1"></a>We observe the following:</span>
<span id="cb30-650"><a href="#cb30-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-651"><a href="#cb30-651" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The top 3 lowest trade volume happened in Apr - Jun 2020 --<span class="sc">\&gt;</span> This coincides with the economic slowdown in major economies and supply chain disruptions as well as the implementation of the circuit Breaker (CB) measures domestically from April to June 2020.</span>
<span id="cb30-652"><a href="#cb30-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-653"><a href="#cb30-653" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Singapore trade volume continue to increase from Mar 2021 onwards due to relaxation of covid-restrictions. This is observed by green (high trade volumes) from Mar - Sep 2022. In Oct 2022, there is a slowdown due to recession.</span>
<span id="cb30-654"><a href="#cb30-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-657"><a href="#cb30-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-658"><a href="#cb30-658" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the base plot</span></span>
<span id="cb30-659"><a href="#cb30-659" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(totalsgtrade_calmap <span class="sc">%&gt;%</span> </span>
<span id="cb30-660"><a href="#cb30-660" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">factor</span>(Year, <span class="at">levels =</span><span class="fu">c</span>(<span class="dv">2022</span>,<span class="dv">2021</span>,<span class="dv">2020</span>))), </span>
<span id="cb30-661"><a href="#cb30-661" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Month, </span>
<span id="cb30-662"><a href="#cb30-662" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Year, </span>
<span id="cb30-663"><a href="#cb30-663" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> Trade_Balance)) <span class="sc">+</span> </span>
<span id="cb30-664"><a href="#cb30-664" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-665"><a href="#cb30-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb30-666"><a href="#cb30-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-667"><a href="#cb30-667" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the colors for the main plot</span></span>
<span id="cb30-668"><a href="#cb30-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">name =</span> <span class="st">"Trade Balance (Billions SGD)"</span>,</span>
<span id="cb30-669"><a href="#cb30-669" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colors=</span><span class="fu">c</span>(<span class="st">"#fc8d59"</span>,<span class="st">"grey90"</span>,<span class="st">"#5ab4ac"</span>),</span>
<span id="cb30-670"><a href="#cb30-670" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits=</span><span class="fu">c</span>(<span class="fu">min</span>(totalsgtrade_calmap<span class="sc">$</span>Trade_Balance),<span class="fu">max</span>(totalsgtrade_calmap<span class="sc">$</span>Trade_Balance))) <span class="sc">+</span></span>
<span id="cb30-671"><a href="#cb30-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-672"><a href="#cb30-672" aria-hidden="true" tabindex="-1"></a><span class="co">#Ensure equal scales for both coordinates  </span></span>
<span id="cb30-673"><a href="#cb30-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb30-674"><a href="#cb30-674" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-675"><a href="#cb30-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-676"><a href="#cb30-676" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb30-677"><a href="#cb30-677" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),</span>
<span id="cb30-678"><a href="#cb30-678" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb30-679"><a href="#cb30-679" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-680"><a href="#cb30-680" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding title, subtitle, and captions</span></span>
<span id="cb30-681"><a href="#cb30-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb30-682"><a href="#cb30-682" aria-hidden="true" tabindex="-1"></a>     <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb30-683"><a href="#cb30-683" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Singapore Trade Balance by calendar months, 2020-2022"</span>,</span>
<span id="cb30-684"><a href="#cb30-684" aria-hidden="true" tabindex="-1"></a>     <span class="at">caption =</span> <span class="st">"Department of Statistics, Singapore"</span>) </span>
<span id="cb30-685"><a href="#cb30-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-686"><a href="#cb30-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-687"><a href="#cb30-687" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Insights</span><span class="co">]</span>{.underline}</span>
<span id="cb30-688"><a href="#cb30-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-689"><a href="#cb30-689" aria-hidden="true" tabindex="-1"></a>We observe the following:</span>
<span id="cb30-690"><a href="#cb30-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-691"><a href="#cb30-691" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Across all three years, Singapore exports more than it imports, which may be attributed to its strategic location.</span>
<span id="cb30-692"><a href="#cb30-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-693"><a href="#cb30-693" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Imports exceed exports in May 2022, resulting in a negative trade balance. The same pattern could be seen in April-August 2022 and October-December 2022. This could be because, as the United States enters a recession (Summer 2022 &amp; Oct 2022), Singapore is not immune, and the world economy enters a slump, with fewer exports. While Singapore continues to import, which is understandable given the country's scarcity of natural resources.</span>
<span id="cb30-694"><a href="#cb30-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-695"><a href="#cb30-695" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2 Trade Balance of Singapore</span></span>
<span id="cb30-696"><a href="#cb30-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-697"><a href="#cb30-697" aria-hidden="true" tabindex="-1"></a>The difference between a country's exports and imports for a certain period is known as the balance of trade (BOT). A country with a trade deficit imports more products and services than it exports in terms of value, whereas a country with a trade surplus exports more goods and services than it imports.</span>
<span id="cb30-698"><a href="#cb30-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-699"><a href="#cb30-699" aria-hidden="true" tabindex="-1"></a>We utilize a horizon graph to show Singapore's trade balance trend over the last three years, broken down by region. Each row represents a different country, with red representing a trade deficit and blue representing a trade surplus.</span>
<span id="cb30-700"><a href="#cb30-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-701"><a href="#cb30-701" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Insights</span><span class="co">]</span>{.underline}</span>
<span id="cb30-702"><a href="#cb30-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-703"><a href="#cb30-703" aria-hidden="true" tabindex="-1"></a>We can examine the main importers/exporters and trading activities of trading partners over time. We also observe that there is less trading activity with countries in America and Europe. Singapore primarily trades in Asia Pacific, possibly due to proximity.</span>
<span id="cb30-704"><a href="#cb30-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-705"><a href="#cb30-705" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In Asia, we mostly export (blue) to Hong Kong, Indonesia, and Vietnam. We primarily import (red) from Malaysia and Taiwan.</span>
<span id="cb30-706"><a href="#cb30-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-707"><a href="#cb30-707" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In the United States, we mostly export (blue) to Guam and Puerto Rico. While we mostly import (red) from the United States, we also import from Brazil.</span>
<span id="cb30-708"><a href="#cb30-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-709"><a href="#cb30-709" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In Europe, we mostly export (blue) to the Netherlands and Greece. While we mostly import (red) from Italy, Spain, Sweden, Switzerland, and the United Kingdom. This could be because of free trade agreements with the European Union.</span>
<span id="cb30-710"><a href="#cb30-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-711"><a href="#cb30-711" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We mostly export to countries in Oceania.</span>
<span id="cb30-712"><a href="#cb30-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-713"><a href="#cb30-713" aria-hidden="true" tabindex="-1"></a>What is noteworthy about this analysis is that we observe&nbsp;that we often export to smaller countries while importing from larger countries. This could be due to Singapore's many bilateral and regional FTAs including with Australia, China, Costa Rica, India, Japan, Jordan, New Zealand, Republic of Korea, Panama, Peru, Sri Lanka, European Union, United Kingdom and Turkey.</span>
<span id="cb30-714"><a href="#cb30-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-715"><a href="#cb30-715" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb30-716"><a href="#cb30-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-717"><a href="#cb30-717" aria-hidden="true" tabindex="-1"></a><span class="fu">## Asia</span></span>
<span id="cb30-718"><a href="#cb30-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-719"><a href="#cb30-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.align="center", echo = FALSE, fig.width= 20, fig.height=15}</span></span>
<span id="cb30-720"><a href="#cb30-720" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>totalsgtrade_asia_tradebalance) <span class="sc">+</span></span>
<span id="cb30-721"><a href="#cb30-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_horizon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Month_Year, <span class="at">y=</span>Trade_Balance_SGD), </span>
<span id="cb30-722"><a href="#cb30-722" aria-hidden="true" tabindex="-1"></a>               <span class="at">origin =</span> <span class="dv">0</span>, </span>
<span id="cb30-723"><a href="#cb30-723" aria-hidden="true" tabindex="-1"></a>               <span class="at">horizonscale =</span> <span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb30-724"><a href="#cb30-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Countries<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb30-725"><a href="#cb30-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hcl</span>(<span class="at">palette =</span> <span class="st">'RdBu'</span>) <span class="sc">+</span></span>
<span id="cb30-726"><a href="#cb30-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.spacing.y=</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"lines"</span>), </span>
<span id="cb30-727"><a href="#cb30-727" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb30-728"><a href="#cb30-728" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb30-729"><a href="#cb30-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-730"><a href="#cb30-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.5</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb30-731"><a href="#cb30-731" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-732"><a href="#cb30-732" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-733"><a href="#cb30-733" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-734"><a href="#cb30-734" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-735"><a href="#cb30-735" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>, <span class="at">face=</span><span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb30-736"><a href="#cb30-736" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">date_breaks =</span> <span class="st">"2 month"</span>, <span class="at">date_labels =</span> <span class="st">"%b'%y"</span>) <span class="sc">+</span></span>
<span id="cb30-737"><a href="#cb30-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Singapore Quarterly Trade Balance with countries in Asia Region (2020-2022)'</span>,</span>
<span id="cb30-738"><a href="#cb30-738" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Department of Statistics, Singapore"</span>)</span>
<span id="cb30-739"><a href="#cb30-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-740"><a href="#cb30-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-741"><a href="#cb30-741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-742"><a href="#cb30-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-743"><a href="#cb30-743" aria-hidden="true" tabindex="-1"></a><span class="fu">## America</span></span>
<span id="cb30-744"><a href="#cb30-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-745"><a href="#cb30-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.align="center", echo = FALSE, fig.width= 20, fig.height=15}</span></span>
<span id="cb30-746"><a href="#cb30-746" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>totalsgtrade_america_tradebalance) <span class="sc">+</span></span>
<span id="cb30-747"><a href="#cb30-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_horizon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Month_Year, <span class="at">y=</span>Trade_Balance_SGD), </span>
<span id="cb30-748"><a href="#cb30-748" aria-hidden="true" tabindex="-1"></a>               <span class="at">origin =</span> <span class="dv">0</span>, </span>
<span id="cb30-749"><a href="#cb30-749" aria-hidden="true" tabindex="-1"></a>               <span class="at">horizonscale =</span> <span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb30-750"><a href="#cb30-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Countries<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb30-751"><a href="#cb30-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hcl</span>(<span class="at">palette =</span> <span class="st">'RdBu'</span>) <span class="sc">+</span></span>
<span id="cb30-752"><a href="#cb30-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.spacing.y=</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"lines"</span>), </span>
<span id="cb30-753"><a href="#cb30-753" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb30-754"><a href="#cb30-754" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb30-755"><a href="#cb30-755" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-756"><a href="#cb30-756" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.5</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb30-757"><a href="#cb30-757" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-758"><a href="#cb30-758" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-759"><a href="#cb30-759" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-760"><a href="#cb30-760" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-761"><a href="#cb30-761" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>, <span class="at">face=</span><span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb30-762"><a href="#cb30-762" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">date_breaks =</span> <span class="st">"2 month"</span>, <span class="at">date_labels =</span> <span class="st">"%b'%y"</span>) <span class="sc">+</span></span>
<span id="cb30-763"><a href="#cb30-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Singapore Quarterly Trade Balance with countries in America region(2020-2022)'</span>,</span>
<span id="cb30-764"><a href="#cb30-764" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Department of Statistics, Singapore"</span>)</span>
<span id="cb30-765"><a href="#cb30-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-766"><a href="#cb30-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-767"><a href="#cb30-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-768"><a href="#cb30-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-769"><a href="#cb30-769" aria-hidden="true" tabindex="-1"></a><span class="fu">## Europe</span></span>
<span id="cb30-770"><a href="#cb30-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-771"><a href="#cb30-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.align="center", echo = FALSE, fig.width= 20, fig.height=15}</span></span>
<span id="cb30-772"><a href="#cb30-772" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>totalsgtrade_europe_tradebalance) <span class="sc">+</span></span>
<span id="cb30-773"><a href="#cb30-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_horizon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Month_Year, <span class="at">y=</span>Trade_Balance_SGD), </span>
<span id="cb30-774"><a href="#cb30-774" aria-hidden="true" tabindex="-1"></a>               <span class="at">origin =</span> <span class="dv">0</span>, </span>
<span id="cb30-775"><a href="#cb30-775" aria-hidden="true" tabindex="-1"></a>               <span class="at">horizonscale =</span> <span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb30-776"><a href="#cb30-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Countries<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb30-777"><a href="#cb30-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hcl</span>(<span class="at">palette =</span> <span class="st">'RdBu'</span>) <span class="sc">+</span></span>
<span id="cb30-778"><a href="#cb30-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.spacing.y=</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"lines"</span>), </span>
<span id="cb30-779"><a href="#cb30-779" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb30-780"><a href="#cb30-780" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb30-781"><a href="#cb30-781" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-782"><a href="#cb30-782" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.5</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb30-783"><a href="#cb30-783" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-784"><a href="#cb30-784" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-785"><a href="#cb30-785" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-786"><a href="#cb30-786" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-787"><a href="#cb30-787" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>, <span class="at">face=</span><span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb30-788"><a href="#cb30-788" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">date_breaks =</span> <span class="st">"2 month"</span>, <span class="at">date_labels =</span> <span class="st">"%b'%y"</span>) <span class="sc">+</span></span>
<span id="cb30-789"><a href="#cb30-789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Singapore Quarterly Trade Balance with countries in Europe region (2020-2022)'</span>,</span>
<span id="cb30-790"><a href="#cb30-790" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Department of Statistics, Singapore"</span>)</span>
<span id="cb30-791"><a href="#cb30-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-792"><a href="#cb30-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-793"><a href="#cb30-793" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-794"><a href="#cb30-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-795"><a href="#cb30-795" aria-hidden="true" tabindex="-1"></a><span class="fu">## Oceania</span></span>
<span id="cb30-796"><a href="#cb30-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-799"><a href="#cb30-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-800"><a href="#cb30-800" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>totalsgtrade_oceania_tradebalance) <span class="sc">+</span></span>
<span id="cb30-801"><a href="#cb30-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_horizon</span>(<span class="fu">aes</span>(<span class="at">x=</span>Month_Year, <span class="at">y=</span>Trade_Balance_SGD), </span>
<span id="cb30-802"><a href="#cb30-802" aria-hidden="true" tabindex="-1"></a>               <span class="at">origin =</span> <span class="dv">0</span>, </span>
<span id="cb30-803"><a href="#cb30-803" aria-hidden="true" tabindex="-1"></a>               <span class="at">horizonscale =</span> <span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb30-804"><a href="#cb30-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Countries<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb30-805"><a href="#cb30-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_hcl</span>(<span class="at">palette =</span> <span class="st">'RdBu'</span>) <span class="sc">+</span></span>
<span id="cb30-806"><a href="#cb30-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.spacing.y=</span><span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"lines"</span>), </span>
<span id="cb30-807"><a href="#cb30-807" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb30-808"><a href="#cb30-808" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb30-809"><a href="#cb30-809" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-810"><a href="#cb30-810" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fl">6.5</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb30-811"><a href="#cb30-811" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-812"><a href="#cb30-812" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-813"><a href="#cb30-813" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-814"><a href="#cb30-814" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-815"><a href="#cb30-815" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">13</span>, <span class="at">face=</span><span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb30-816"><a href="#cb30-816" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">date_breaks =</span> <span class="st">"2 month"</span>, <span class="at">date_labels =</span> <span class="st">"%b'%y"</span>) <span class="sc">+</span></span>
<span id="cb30-817"><a href="#cb30-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Singapore Quarterly Trade Balance with countries in Oceania region (2020-2022)'</span>, </span>
<span id="cb30-818"><a href="#cb30-818" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Department of Statistics, Singapore"</span>)</span>
<span id="cb30-819"><a href="#cb30-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-820"><a href="#cb30-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-821"><a href="#cb30-821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-822"><a href="#cb30-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-823"><a href="#cb30-823" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.3 Export-Import Graphs</span></span>
<span id="cb30-824"><a href="#cb30-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-825"><a href="#cb30-825" aria-hidden="true" tabindex="-1"></a>Plotting both export and import line into the same graph allows us to examine Singapore's exports and imports easier over time. The user can easily determine whether each country's trade activities are in surplus (green) or deficit (purple).</span>
<span id="cb30-826"><a href="#cb30-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-827"><a href="#cb30-827" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Insights</span><span class="co">]</span>{.underline}</span>
<span id="cb30-828"><a href="#cb30-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-829"><a href="#cb30-829" aria-hidden="true" tabindex="-1"></a>Singapore has experienced a trade surplus for the last three years, as shown in the green region, which is more than the purple area. The result is consistent with the trade summary from <span class="co">[</span><span class="ot">World Bank.org</span><span class="co">](https://wits.worldbank.org/CountrySnapshot/en/SGP/textview#:~:text=Singapore%2C%20Imports%20of%20goods%20and,percentage%20of%20GDP%20is%20176.24%20%25.)</span>. This was also evident in the heatmap, which showed a low trade balance in May 2022. Trade activity falls sharply between February 2020 and December 2021. The drop in February 2020 was caused by Covid-19 shutdown restrictions and a standstill in global economic activity, during which the Singapore economy experienced both demand- and supply-side disruptions. Whereas the second drop in trade activity in December 2021 could be related to the uncertainty of Russia invading Ukraine. The decrease continued&nbsp;until February 2022, when the Russia-Ukraine war begin. On the other hand, imports and exports increased&nbsp;in March 2021 which could be due to easing of Covid restrictions.</span>
<span id="cb30-830"><a href="#cb30-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-831"><a href="#cb30-831" aria-hidden="true" tabindex="-1"></a>Similar patterns can be found in different regions, as evidenced by the Trade Balance, where trade activity are lower in countries in America and higher in Asia. It's worth noting that several countries had a mix of trade surpluses and trade deficits (e.g. Korea, China, US). For example, exports to China increased from July 2020 to April 2022, which might be linked to the pandemic and China's strict zero covid policy, which delayed China's opening and consequently lowered imports.</span>
<span id="cb30-832"><a href="#cb30-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-833"><a href="#cb30-833" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb30-834"><a href="#cb30-834" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overall</span></span>
<span id="cb30-835"><a href="#cb30-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-838"><a href="#cb30-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-839"><a href="#cb30-839" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the base plot</span></span>
<span id="cb30-840"><a href="#cb30-840" aria-hidden="true" tabindex="-1"></a>br_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-841"><a href="#cb30-841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> totalsgtrade_long,</span>
<span id="cb30-842"><a href="#cb30-842" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-843"><a href="#cb30-843" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Values,</span>
<span id="cb30-844"><a href="#cb30-844" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> Type,</span>
<span id="cb30-845"><a href="#cb30-845" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> Type),</span>
<span id="cb30-846"><a href="#cb30-846" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-847"><a href="#cb30-847" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-848"><a href="#cb30-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_braid</span>(<span class="at">data =</span> totalsgtrade,</span>
<span id="cb30-849"><a href="#cb30-849" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-850"><a href="#cb30-850" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymin =</span> Import,</span>
<span id="cb30-851"><a href="#cb30-851" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymax =</span> Export,</span>
<span id="cb30-852"><a href="#cb30-852" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> Import <span class="sc">&lt;</span> Export),</span>
<span id="cb30-853"><a href="#cb30-853" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-854"><a href="#cb30-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-855"><a href="#cb30-855" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove the legend </span></span>
<span id="cb30-856"><a href="#cb30-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-857"><a href="#cb30-857" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-858"><a href="#cb30-858" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding the 'Import' and 'Export' labels at the end of the line charts</span></span>
<span id="cb30-859"><a href="#cb30-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dl</span>(<span class="at">data =</span> totalsgtrade_long,</span>
<span id="cb30-860"><a href="#cb30-860" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-861"><a href="#cb30-861" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> Values,</span>
<span id="cb30-862"><a href="#cb30-862" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> Type,</span>
<span id="cb30-863"><a href="#cb30-863" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> Type),</span>
<span id="cb30-864"><a href="#cb30-864" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="fu">list</span>(<span class="fu">dl.trans</span>(<span class="at">x =</span> x <span class="sc">+</span> <span class="fl">0.2</span>), <span class="st">"last.points"</span>, <span class="at">cex =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-865"><a href="#cb30-865" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-866"><a href="#cb30-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dl</span>(<span class="at">data =</span> totalsgtrade_long,</span>
<span id="cb30-867"><a href="#cb30-867" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-868"><a href="#cb30-868" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> Values,</span>
<span id="cb30-869"><a href="#cb30-869" aria-hidden="true" tabindex="-1"></a>              <span class="at">label =</span> Type,</span>
<span id="cb30-870"><a href="#cb30-870" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> Type),</span>
<span id="cb30-871"><a href="#cb30-871" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="fu">list</span>(<span class="fu">dl.trans</span>(<span class="at">x =</span> x <span class="sc">-</span> <span class="fl">0.2</span>), <span class="st">"first.points"</span>, <span class="at">cex =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb30-872"><a href="#cb30-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-873"><a href="#cb30-873" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the colors for the main plot  </span></span>
<span id="cb30-874"><a href="#cb30-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7fbf7b"</span>, <span class="st">"#af8dc3"</span>),</span>
<span id="cb30-875"><a href="#cb30-875" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Export"</span>, <span class="st">"Import"</span>),</span>
<span id="cb30-876"><a href="#cb30-876" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-877"><a href="#cb30-877" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-878"><a href="#cb30-878" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-879"><a href="#cb30-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#cbd5e8"</span>, <span class="st">"#B6DAB4"</span>)) <span class="sc">+</span></span>
<span id="cb30-880"><a href="#cb30-880" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-881"><a href="#cb30-881" aria-hidden="true" tabindex="-1"></a><span class="co">#Adjusting the scale</span></span>
<span id="cb30-882"><a href="#cb30-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb30-883"><a href="#cb30-883" aria-hidden="true" tabindex="-1"></a>               <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">"2020-01-01"</span>),<span class="fu">as.Date</span>(<span class="st">"2023-03-31"</span>)),</span>
<span id="cb30-884"><a href="#cb30-884" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_breaks =</span> <span class="st">"3 month"</span>,</span>
<span id="cb30-885"><a href="#cb30-885" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="sc">+</span></span>
<span id="cb30-886"><a href="#cb30-886" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-887"><a href="#cb30-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Trade Values"</span>,</span>
<span id="cb30-888"><a href="#cb30-888" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x){<span class="fu">paste0</span>(<span class="st">'$'</span>, <span class="fu">abs</span>(x<span class="sc">/</span><span class="dv">1000000000</span>),<span class="st">'B'</span>)}) <span class="sc">+</span></span>
<span id="cb30-889"><a href="#cb30-889" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-890"><a href="#cb30-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-891"><a href="#cb30-891" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb30-892"><a href="#cb30-892" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">'top'</span>,</span>
<span id="cb30-893"><a href="#cb30-893" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">'center'</span>,</span>
<span id="cb30-894"><a href="#cb30-894" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb30-895"><a href="#cb30-895" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-896"><a href="#cb30-896" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding title, subtitle, and captions   </span></span>
<span id="cb30-897"><a href="#cb30-897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Singapore overall trade activities"</span>,</span>
<span id="cb30-898"><a href="#cb30-898" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2020-2022"</span>,</span>
<span id="cb30-899"><a href="#cb30-899" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Department of Statistics, Singapore"</span>)</span>
<span id="cb30-900"><a href="#cb30-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-901"><a href="#cb30-901" aria-hidden="true" tabindex="-1"></a>br_plot</span>
<span id="cb30-902"><a href="#cb30-902" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-903"><a href="#cb30-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-904"><a href="#cb30-904" aria-hidden="true" tabindex="-1"></a><span class="fu">## Asia</span></span>
<span id="cb30-905"><a href="#cb30-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-908"><a href="#cb30-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-909"><a href="#cb30-909" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the base plot</span></span>
<span id="cb30-910"><a href="#cb30-910" aria-hidden="true" tabindex="-1"></a>br_plot_asia <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-911"><a href="#cb30-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> totalsgtrade_long_asia,</span>
<span id="cb30-912"><a href="#cb30-912" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-913"><a href="#cb30-913" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Values,</span>
<span id="cb30-914"><a href="#cb30-914" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> Type,</span>
<span id="cb30-915"><a href="#cb30-915" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> Type),</span>
<span id="cb30-916"><a href="#cb30-916" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-917"><a href="#cb30-917" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-918"><a href="#cb30-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_braid</span>(<span class="at">data =</span> totalsgtrade_asia,</span>
<span id="cb30-919"><a href="#cb30-919" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-920"><a href="#cb30-920" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymin =</span> Import,</span>
<span id="cb30-921"><a href="#cb30-921" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymax =</span> Export,</span>
<span id="cb30-922"><a href="#cb30-922" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> Import <span class="sc">&lt;</span> Export),</span>
<span id="cb30-923"><a href="#cb30-923" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-924"><a href="#cb30-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-925"><a href="#cb30-925" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove the legend </span></span>
<span id="cb30-926"><a href="#cb30-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-927"><a href="#cb30-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Countries, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb30-928"><a href="#cb30-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-929"><a href="#cb30-929" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the colors for the main plot  </span></span>
<span id="cb30-930"><a href="#cb30-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7fbf7b"</span>, <span class="st">"#af8dc3"</span>),</span>
<span id="cb30-931"><a href="#cb30-931" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Export"</span>, <span class="st">"Import"</span>),</span>
<span id="cb30-932"><a href="#cb30-932" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-933"><a href="#cb30-933" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-934"><a href="#cb30-934" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-935"><a href="#cb30-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#cbd5e8"</span>, <span class="st">"#B6DAB4"</span>)) <span class="sc">+</span></span>
<span id="cb30-936"><a href="#cb30-936" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-937"><a href="#cb30-937" aria-hidden="true" tabindex="-1"></a><span class="co">#Adjusting the scale</span></span>
<span id="cb30-938"><a href="#cb30-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb30-939"><a href="#cb30-939" aria-hidden="true" tabindex="-1"></a>               <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">"2020-01-01"</span>),<span class="fu">as.Date</span>(<span class="st">"2023-03-31"</span>)),</span>
<span id="cb30-940"><a href="#cb30-940" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_breaks =</span> <span class="st">"3 month"</span>,</span>
<span id="cb30-941"><a href="#cb30-941" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="sc">+</span></span>
<span id="cb30-942"><a href="#cb30-942" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-943"><a href="#cb30-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Trade Values"</span>,</span>
<span id="cb30-944"><a href="#cb30-944" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x){<span class="fu">paste0</span>(<span class="st">'$'</span>, <span class="fu">abs</span>(x<span class="sc">/</span><span class="dv">1000000000</span>),<span class="st">'B'</span>)}) <span class="sc">+</span></span>
<span id="cb30-945"><a href="#cb30-945" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-946"><a href="#cb30-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-947"><a href="#cb30-947" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb30-948"><a href="#cb30-948" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">'top'</span>,</span>
<span id="cb30-949"><a href="#cb30-949" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">'center'</span>,</span>
<span id="cb30-950"><a href="#cb30-950" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb30-951"><a href="#cb30-951" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-952"><a href="#cb30-952" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding title, subtitle, and captions   </span></span>
<span id="cb30-953"><a href="#cb30-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Asia-Singapore trade activities"</span>,</span>
<span id="cb30-954"><a href="#cb30-954" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2020-2022"</span>,</span>
<span id="cb30-955"><a href="#cb30-955" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Note: The shaded green area represents Export value &gt; Import value, indicating a trade surplus. </span><span class="sc">\n</span><span class="st"> The shaded purple area represents Export value &lt; Import value, indicating a trade deficit."</span>) <span class="sc">+</span></span>
<span id="cb30-956"><a href="#cb30-956" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb30-957"><a href="#cb30-957" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), </span>
<span id="cb30-958"><a href="#cb30-958" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>, <span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb30-959"><a href="#cb30-959" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-960"><a href="#cb30-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-961"><a href="#cb30-961" aria-hidden="true" tabindex="-1"></a>br_plot_asia</span>
<span id="cb30-962"><a href="#cb30-962" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-963"><a href="#cb30-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-964"><a href="#cb30-964" aria-hidden="true" tabindex="-1"></a><span class="fu">## America</span></span>
<span id="cb30-965"><a href="#cb30-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-968"><a href="#cb30-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-969"><a href="#cb30-969" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the base plot</span></span>
<span id="cb30-970"><a href="#cb30-970" aria-hidden="true" tabindex="-1"></a>br_plot_america <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-971"><a href="#cb30-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> totalsgtrade_long_america,</span>
<span id="cb30-972"><a href="#cb30-972" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-973"><a href="#cb30-973" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Values,</span>
<span id="cb30-974"><a href="#cb30-974" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> Type,</span>
<span id="cb30-975"><a href="#cb30-975" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> Type),</span>
<span id="cb30-976"><a href="#cb30-976" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-977"><a href="#cb30-977" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-978"><a href="#cb30-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_braid</span>(<span class="at">data =</span> totalsgtrade_america,</span>
<span id="cb30-979"><a href="#cb30-979" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-980"><a href="#cb30-980" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymin =</span> Import,</span>
<span id="cb30-981"><a href="#cb30-981" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymax =</span> Export,</span>
<span id="cb30-982"><a href="#cb30-982" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> Import <span class="sc">&lt;</span> Export),</span>
<span id="cb30-983"><a href="#cb30-983" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-984"><a href="#cb30-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-985"><a href="#cb30-985" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove the legend </span></span>
<span id="cb30-986"><a href="#cb30-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-987"><a href="#cb30-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Countries, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb30-988"><a href="#cb30-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-989"><a href="#cb30-989" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the colors for the main plot  </span></span>
<span id="cb30-990"><a href="#cb30-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7fbf7b"</span>, <span class="st">"#af8dc3"</span>),</span>
<span id="cb30-991"><a href="#cb30-991" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Export"</span>, <span class="st">"Import"</span>),</span>
<span id="cb30-992"><a href="#cb30-992" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-993"><a href="#cb30-993" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-994"><a href="#cb30-994" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-995"><a href="#cb30-995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#cbd5e8"</span>, <span class="st">"#B6DAB4"</span>)) <span class="sc">+</span></span>
<span id="cb30-996"><a href="#cb30-996" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-997"><a href="#cb30-997" aria-hidden="true" tabindex="-1"></a><span class="co">#Adjusting the scale</span></span>
<span id="cb30-998"><a href="#cb30-998" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb30-999"><a href="#cb30-999" aria-hidden="true" tabindex="-1"></a>               <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">"2020-01-01"</span>),<span class="fu">as.Date</span>(<span class="st">"2023-03-31"</span>)),</span>
<span id="cb30-1000"><a href="#cb30-1000" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_breaks =</span> <span class="st">"3 month"</span>,</span>
<span id="cb30-1001"><a href="#cb30-1001" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="sc">+</span></span>
<span id="cb30-1002"><a href="#cb30-1002" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1003"><a href="#cb30-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Trade Values"</span>,</span>
<span id="cb30-1004"><a href="#cb30-1004" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x){<span class="fu">paste0</span>(<span class="st">'$'</span>, <span class="fu">abs</span>(x<span class="sc">/</span><span class="dv">1000000000</span>),<span class="st">'B'</span>)}) <span class="sc">+</span></span>
<span id="cb30-1005"><a href="#cb30-1005" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1006"><a href="#cb30-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-1007"><a href="#cb30-1007" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb30-1008"><a href="#cb30-1008" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">'top'</span>,</span>
<span id="cb30-1009"><a href="#cb30-1009" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">'center'</span>,</span>
<span id="cb30-1010"><a href="#cb30-1010" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb30-1011"><a href="#cb30-1011" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1012"><a href="#cb30-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding title, subtitle, and captions   </span></span>
<span id="cb30-1013"><a href="#cb30-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"America-Singapore trade activities"</span>,</span>
<span id="cb30-1014"><a href="#cb30-1014" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2020-2022"</span>,</span>
<span id="cb30-1015"><a href="#cb30-1015" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Note: The shaded green area represents Export value &gt; Import value, indicating a trade surplus. </span><span class="sc">\n</span><span class="st"> The shaded purple area represents Export value &lt; Import value, indicating a trade deficit."</span>) <span class="sc">+</span></span>
<span id="cb30-1016"><a href="#cb30-1016" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb30-1017"><a href="#cb30-1017" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), </span>
<span id="cb30-1018"><a href="#cb30-1018" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>, <span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb30-1019"><a href="#cb30-1019" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-1020"><a href="#cb30-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1021"><a href="#cb30-1021" aria-hidden="true" tabindex="-1"></a>br_plot_america</span>
<span id="cb30-1022"><a href="#cb30-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-1023"><a href="#cb30-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1024"><a href="#cb30-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">## Europe</span></span>
<span id="cb30-1025"><a href="#cb30-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1028"><a href="#cb30-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-1029"><a href="#cb30-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the base plot</span></span>
<span id="cb30-1030"><a href="#cb30-1030" aria-hidden="true" tabindex="-1"></a>br_plot_europe <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-1031"><a href="#cb30-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> totalsgtrade_long_europe,</span>
<span id="cb30-1032"><a href="#cb30-1032" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-1033"><a href="#cb30-1033" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Values,</span>
<span id="cb30-1034"><a href="#cb30-1034" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> Type,</span>
<span id="cb30-1035"><a href="#cb30-1035" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> Type),</span>
<span id="cb30-1036"><a href="#cb30-1036" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-1037"><a href="#cb30-1037" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1038"><a href="#cb30-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_braid</span>(<span class="at">data =</span> totalsgtrade_europe,</span>
<span id="cb30-1039"><a href="#cb30-1039" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-1040"><a href="#cb30-1040" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymin =</span> Import,</span>
<span id="cb30-1041"><a href="#cb30-1041" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymax =</span> Export,</span>
<span id="cb30-1042"><a href="#cb30-1042" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> Import <span class="sc">&lt;</span> Export),</span>
<span id="cb30-1043"><a href="#cb30-1043" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-1044"><a href="#cb30-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1045"><a href="#cb30-1045" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove the legend </span></span>
<span id="cb30-1046"><a href="#cb30-1046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-1047"><a href="#cb30-1047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Countries, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb30-1048"><a href="#cb30-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1049"><a href="#cb30-1049" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the colors for the main plot  </span></span>
<span id="cb30-1050"><a href="#cb30-1050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7fbf7b"</span>, <span class="st">"#af8dc3"</span>),</span>
<span id="cb30-1051"><a href="#cb30-1051" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Export"</span>, <span class="st">"Import"</span>),</span>
<span id="cb30-1052"><a href="#cb30-1052" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-1053"><a href="#cb30-1053" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-1054"><a href="#cb30-1054" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1055"><a href="#cb30-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#cbd5e8"</span>, <span class="st">"#B6DAB4"</span>)) <span class="sc">+</span></span>
<span id="cb30-1056"><a href="#cb30-1056" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1057"><a href="#cb30-1057" aria-hidden="true" tabindex="-1"></a><span class="co">#Adjusting the scale</span></span>
<span id="cb30-1058"><a href="#cb30-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb30-1059"><a href="#cb30-1059" aria-hidden="true" tabindex="-1"></a>               <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">"2020-01-01"</span>),<span class="fu">as.Date</span>(<span class="st">"2023-03-31"</span>)),</span>
<span id="cb30-1060"><a href="#cb30-1060" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_breaks =</span> <span class="st">"3 month"</span>,</span>
<span id="cb30-1061"><a href="#cb30-1061" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="sc">+</span></span>
<span id="cb30-1062"><a href="#cb30-1062" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1063"><a href="#cb30-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Trade Values"</span>,</span>
<span id="cb30-1064"><a href="#cb30-1064" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x){<span class="fu">paste0</span>(<span class="st">'$'</span>, <span class="fu">abs</span>(x<span class="sc">/</span><span class="dv">1000000000</span>),<span class="st">'B'</span>)}) <span class="sc">+</span></span>
<span id="cb30-1065"><a href="#cb30-1065" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1066"><a href="#cb30-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-1067"><a href="#cb30-1067" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb30-1068"><a href="#cb30-1068" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">'top'</span>,</span>
<span id="cb30-1069"><a href="#cb30-1069" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">'center'</span>,</span>
<span id="cb30-1070"><a href="#cb30-1070" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb30-1071"><a href="#cb30-1071" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1072"><a href="#cb30-1072" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding title, subtitle, and captions   </span></span>
<span id="cb30-1073"><a href="#cb30-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Europe-Singapore trade activities"</span>,</span>
<span id="cb30-1074"><a href="#cb30-1074" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2020-2022"</span>,</span>
<span id="cb30-1075"><a href="#cb30-1075" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Note: The shaded green area represents Export value &gt; Import value, indicating a trade surplus. </span><span class="sc">\n</span><span class="st"> The shaded purple area represents Export value &lt; Import value, indicating a trade deficit."</span>) <span class="sc">+</span></span>
<span id="cb30-1076"><a href="#cb30-1076" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb30-1077"><a href="#cb30-1077" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), </span>
<span id="cb30-1078"><a href="#cb30-1078" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>, <span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb30-1079"><a href="#cb30-1079" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-1080"><a href="#cb30-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1081"><a href="#cb30-1081" aria-hidden="true" tabindex="-1"></a>br_plot_europe</span>
<span id="cb30-1082"><a href="#cb30-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-1083"><a href="#cb30-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1084"><a href="#cb30-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">## Oceania</span></span>
<span id="cb30-1085"><a href="#cb30-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1088"><a href="#cb30-1088" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-1089"><a href="#cb30-1089" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the base plot</span></span>
<span id="cb30-1090"><a href="#cb30-1090" aria-hidden="true" tabindex="-1"></a>br_plot_oceania <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb30-1091"><a href="#cb30-1091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> totalsgtrade_long_oceania,</span>
<span id="cb30-1092"><a href="#cb30-1092" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-1093"><a href="#cb30-1093" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> Values,</span>
<span id="cb30-1094"><a href="#cb30-1094" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> Type,</span>
<span id="cb30-1095"><a href="#cb30-1095" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> Type),</span>
<span id="cb30-1096"><a href="#cb30-1096" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-1097"><a href="#cb30-1097" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1098"><a href="#cb30-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_braid</span>(<span class="at">data =</span> totalsgtrade_oceania,</span>
<span id="cb30-1099"><a href="#cb30-1099" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> Month_Year,</span>
<span id="cb30-1100"><a href="#cb30-1100" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymin =</span> Import,</span>
<span id="cb30-1101"><a href="#cb30-1101" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ymax =</span> Export,</span>
<span id="cb30-1102"><a href="#cb30-1102" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> Import <span class="sc">&lt;</span> Export),</span>
<span id="cb30-1103"><a href="#cb30-1103" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb30-1104"><a href="#cb30-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1105"><a href="#cb30-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#Remove the legend </span></span>
<span id="cb30-1106"><a href="#cb30-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>, <span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-1107"><a href="#cb30-1107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Countries, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb30-1108"><a href="#cb30-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1109"><a href="#cb30-1109" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the colors for the main plot  </span></span>
<span id="cb30-1110"><a href="#cb30-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7fbf7b"</span>, <span class="st">"#af8dc3"</span>),</span>
<span id="cb30-1111"><a href="#cb30-1111" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Export"</span>, <span class="st">"Import"</span>),</span>
<span id="cb30-1112"><a href="#cb30-1112" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-1113"><a href="#cb30-1113" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb30-1114"><a href="#cb30-1114" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1115"><a href="#cb30-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#cbd5e8"</span>, <span class="st">"#B6DAB4"</span>)) <span class="sc">+</span></span>
<span id="cb30-1116"><a href="#cb30-1116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1117"><a href="#cb30-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#Adjusting the scale</span></span>
<span id="cb30-1118"><a href="#cb30-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb30-1119"><a href="#cb30-1119" aria-hidden="true" tabindex="-1"></a>               <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">"2020-01-01"</span>),<span class="fu">as.Date</span>(<span class="st">"2023-03-31"</span>)),</span>
<span id="cb30-1120"><a href="#cb30-1120" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_breaks =</span> <span class="st">"3 month"</span>,</span>
<span id="cb30-1121"><a href="#cb30-1121" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="sc">+</span></span>
<span id="cb30-1122"><a href="#cb30-1122" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1123"><a href="#cb30-1123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Trade Values"</span>,</span>
<span id="cb30-1124"><a href="#cb30-1124" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="cf">function</span>(x){<span class="fu">paste0</span>(<span class="st">'$'</span>, <span class="fu">abs</span>(x<span class="sc">/</span><span class="dv">1000000000</span>),<span class="st">'B'</span>)}) <span class="sc">+</span></span>
<span id="cb30-1125"><a href="#cb30-1125" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1126"><a href="#cb30-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-1127"><a href="#cb30-1127" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb30-1128"><a href="#cb30-1128" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">'top'</span>,</span>
<span id="cb30-1129"><a href="#cb30-1129" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">'center'</span>,</span>
<span id="cb30-1130"><a href="#cb30-1130" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb30-1131"><a href="#cb30-1131" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1132"><a href="#cb30-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding title, subtitle, and captions   </span></span>
<span id="cb30-1133"><a href="#cb30-1133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Oceania-Singapore trade activities"</span>,</span>
<span id="cb30-1134"><a href="#cb30-1134" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"2020-2022"</span>,</span>
<span id="cb30-1135"><a href="#cb30-1135" aria-hidden="true" tabindex="-1"></a>         <span class="at">caption =</span> <span class="st">"Note: The shaded green area represents Export value &gt; Import value, indicating a trade surplus. </span><span class="sc">\n</span><span class="st"> The shaded purple area represents Export value &lt; Import value, indicating a trade deficit."</span>) <span class="sc">+</span></span>
<span id="cb30-1136"><a href="#cb30-1136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb30-1137"><a href="#cb30-1137" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>), </span>
<span id="cb30-1138"><a href="#cb30-1138" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>, <span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb30-1139"><a href="#cb30-1139" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-1140"><a href="#cb30-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1141"><a href="#cb30-1141" aria-hidden="true" tabindex="-1"></a>br_plot_oceania</span>
<span id="cb30-1142"><a href="#cb30-1142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-1143"><a href="#cb30-1143" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-1144"><a href="#cb30-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1145"><a href="#cb30-1145" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.3 SlopeGraph</span></span>
<span id="cb30-1146"><a href="#cb30-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1147"><a href="#cb30-1147" aria-hidden="true" tabindex="-1"></a>The Slopegraph depicts the year-on-year trend of these countries' total trade balance with Singapore. It is more intuitive for users as the slope-up/slope-down of the lines shows the increase/decrease in trade balance. Here we are only plotting the top 15 trade volume in each region.</span>
<span id="cb30-1148"><a href="#cb30-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1149"><a href="#cb30-1149" aria-hidden="true" tabindex="-1"></a>In Asia, we can see that Hong Kong remains the top exporter of Singapore year on year (increasing trend). While Taiwan remains the top importer of Singapore year on year (decreasing trend).</span>
<span id="cb30-1150"><a href="#cb30-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1151"><a href="#cb30-1151" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb30-1152"><a href="#cb30-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">## Asia</span></span>
<span id="cb30-1153"><a href="#cb30-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1156"><a href="#cb30-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-1157"><a href="#cb30-1157" aria-hidden="true" tabindex="-1"></a><span class="co"># group by year, sum up import and export</span></span>
<span id="cb30-1158"><a href="#cb30-1158" aria-hidden="true" tabindex="-1"></a>CGPfunctions<span class="sc">::</span><span class="fu">newggslopegraph</span>(<span class="at">dataframe =</span> sgtrade_cln_year_Asia,</span>
<span id="cb30-1159"><a href="#cb30-1159" aria-hidden="true" tabindex="-1"></a>                Year, Total_Trade_Balance_BSGD, Countries,</span>
<span id="cb30-1160"><a href="#cb30-1160" aria-hidden="true" tabindex="-1"></a>                <span class="at">Title =</span> <span class="st">"Year-on-Year change of Total Trade Balance (Countries in Asia)"</span>,</span>
<span id="cb30-1161"><a href="#cb30-1161" aria-hidden="true" tabindex="-1"></a>                <span class="at">SubTitle =</span> <span class="st">"2020 - 2022"</span>,</span>
<span id="cb30-1162"><a href="#cb30-1162" aria-hidden="true" tabindex="-1"></a>                <span class="at">Caption =</span> <span class="st">"Department of Statistics, Singapore"</span>)</span>
<span id="cb30-1163"><a href="#cb30-1163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1164"><a href="#cb30-1164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-1165"><a href="#cb30-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1166"><a href="#cb30-1166" aria-hidden="true" tabindex="-1"></a><span class="fu">## America</span></span>
<span id="cb30-1167"><a href="#cb30-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1170"><a href="#cb30-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-1171"><a href="#cb30-1171" aria-hidden="true" tabindex="-1"></a><span class="co"># group by year, sum up import and export</span></span>
<span id="cb30-1172"><a href="#cb30-1172" aria-hidden="true" tabindex="-1"></a>CGPfunctions<span class="sc">::</span><span class="fu">newggslopegraph</span>(<span class="at">dataframe =</span> sgtrade_cln_year_America,</span>
<span id="cb30-1173"><a href="#cb30-1173" aria-hidden="true" tabindex="-1"></a>                Year, Total_Trade_Balance_BSGD, Countries,</span>
<span id="cb30-1174"><a href="#cb30-1174" aria-hidden="true" tabindex="-1"></a>                <span class="at">Title =</span> <span class="st">"Year-on-Year change of Total Trade Balance (Countries in America)"</span>,</span>
<span id="cb30-1175"><a href="#cb30-1175" aria-hidden="true" tabindex="-1"></a>                <span class="at">SubTitle =</span> <span class="st">"2020 - 2022"</span>,</span>
<span id="cb30-1176"><a href="#cb30-1176" aria-hidden="true" tabindex="-1"></a>                <span class="at">Caption =</span> <span class="st">"Department of Statistics, Singapore"</span>)</span>
<span id="cb30-1177"><a href="#cb30-1177" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1178"><a href="#cb30-1178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-1179"><a href="#cb30-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1180"><a href="#cb30-1180" aria-hidden="true" tabindex="-1"></a><span class="fu">## Europe</span></span>
<span id="cb30-1181"><a href="#cb30-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1184"><a href="#cb30-1184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-1185"><a href="#cb30-1185" aria-hidden="true" tabindex="-1"></a><span class="co"># group by year, sum up import and export</span></span>
<span id="cb30-1186"><a href="#cb30-1186" aria-hidden="true" tabindex="-1"></a>CGPfunctions<span class="sc">::</span><span class="fu">newggslopegraph</span>(<span class="at">dataframe =</span> sgtrade_cln_year_Europe,</span>
<span id="cb30-1187"><a href="#cb30-1187" aria-hidden="true" tabindex="-1"></a>                Year, Total_Trade_Balance_BSGD, Countries,</span>
<span id="cb30-1188"><a href="#cb30-1188" aria-hidden="true" tabindex="-1"></a>                <span class="at">Title =</span> <span class="st">"Year-on-Year change of Total Trade Balance (Countries in Europe)"</span>,</span>
<span id="cb30-1189"><a href="#cb30-1189" aria-hidden="true" tabindex="-1"></a>                <span class="at">SubTitle =</span> <span class="st">"2020 - 2022"</span>,</span>
<span id="cb30-1190"><a href="#cb30-1190" aria-hidden="true" tabindex="-1"></a>                <span class="at">Caption =</span> <span class="st">"Department of Statistics, Singapore"</span>)</span>
<span id="cb30-1191"><a href="#cb30-1191" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1192"><a href="#cb30-1192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-1193"><a href="#cb30-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1194"><a href="#cb30-1194" aria-hidden="true" tabindex="-1"></a><span class="fu">## Oceania</span></span>
<span id="cb30-1195"><a href="#cb30-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1198"><a href="#cb30-1198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-1199"><a href="#cb30-1199" aria-hidden="true" tabindex="-1"></a><span class="co"># group by year, sum up import and export</span></span>
<span id="cb30-1200"><a href="#cb30-1200" aria-hidden="true" tabindex="-1"></a>CGPfunctions<span class="sc">::</span><span class="fu">newggslopegraph</span>(<span class="at">dataframe =</span> sgtrade_cln_year_oceania,</span>
<span id="cb30-1201"><a href="#cb30-1201" aria-hidden="true" tabindex="-1"></a>                Year, Total_Trade_Balance_BSGD, Countries,</span>
<span id="cb30-1202"><a href="#cb30-1202" aria-hidden="true" tabindex="-1"></a>                <span class="at">Title =</span> <span class="st">"Year-on-Year change of Total Trade Balance (Countries in Oceania)"</span>,</span>
<span id="cb30-1203"><a href="#cb30-1203" aria-hidden="true" tabindex="-1"></a>                <span class="at">SubTitle =</span> <span class="st">"2020 - 2022"</span>,</span>
<span id="cb30-1204"><a href="#cb30-1204" aria-hidden="true" tabindex="-1"></a>                <span class="at">Caption =</span> <span class="st">"Department of Statistics, Singapore"</span>)</span>
<span id="cb30-1205"><a href="#cb30-1205" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-1206"><a href="#cb30-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-1207"><a href="#cb30-1207" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb30-1208"><a href="#cb30-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1209"><a href="#cb30-1209" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5. References</span></span>
<span id="cb30-1210"><a href="#cb30-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1211"><a href="#cb30-1211" aria-hidden="true" tabindex="-1"></a>https://nsgrantham.github.io/ggbraid/</span>
<span id="cb30-1212"><a href="#cb30-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1213"><a href="#cb30-1213" aria-hidden="true" tabindex="-1"></a>https://www.mti.gov.sg/Trade/Multilateral-and-Regional-Forums</span>
<span id="cb30-1214"><a href="#cb30-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1215"><a href="#cb30-1215" aria-hidden="true" tabindex="-1"></a>https://tradingeconomics.com/singapore/exports</span>
<span id="cb30-1216"><a href="#cb30-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1217"><a href="#cb30-1217" aria-hidden="true" tabindex="-1"></a>https://www.singstat.gov.sg/modules/infographics/singapore-international-trade</span>
<span id="cb30-1218"><a href="#cb30-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1219"><a href="#cb30-1219" aria-hidden="true" tabindex="-1"></a>https://www.enterprisesg.gov.sg/-/media/esg/files/media-centre/media-releases/2020/may-2020/monthly-trade-report---apr-2020.pdf?la=en</span>
<span id="cb30-1220"><a href="#cb30-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-1221"><a href="#cb30-1221" aria-hidden="true" tabindex="-1"></a>https://www.trade.gov/country-commercial-guides/singapore-trade-agreements#:\~:text=Singapore%20also%20has%20many%20bilateral,Union%2C%20United%20Kingdom%20and%20Turkey.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>